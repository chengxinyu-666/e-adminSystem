{"remainingRequest":"D:\\转化仓库\\e-adminSystem\\node_modules\\babel-loader\\lib\\index.js!D:\\转化仓库\\e-adminSystem\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\转化仓库\\e-adminSystem\\src\\permission.js","dependencies":[{"path":"D:\\转化仓库\\e-adminSystem\\src\\permission.js","mtime":1679368696530},{"path":"D:\\转化仓库\\e-adminSystem\\babel.config.js","mtime":1679368691947},{"path":"D:\\转化仓库\\e-adminSystem\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678778409044},{"path":"D:\\转化仓库\\e-adminSystem\\node_modules\\babel-loader\\lib\\index.js","mtime":1678778390429},{"path":"D:\\转化仓库\\e-adminSystem\\node_modules\\eslint-loader\\index.js","mtime":1678778406019}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.function.name\";\n/**\r\n * 全站权限配置\r\n *\r\n */\nimport router from \"./router/router\";\nimport store from \"./store\";\nimport { validatenull } from '@/util/validate';\nimport { getToken } from '@/util/auth';\nimport NProgress from 'nprogress'; // progress bar\nimport 'nprogress/nprogress.css'; // progress bar style\nNProgress.configure({\n  showSpinner: false\n});\nvar lockPage = store.getters.website.lockPage; //锁屏页\nrouter.beforeEach(function (to, from, next) {\n  var meta = to.meta || {};\n  var isMenu = meta.menu === undefined ? to.query.menu : meta.menu;\n  store.commit('SET_IS_MENU', isMenu === undefined);\n  console.log(to);\n  console.log(\"1beforeEach\", to.query.name);\n  console.log(\"1beforeEach\", to.name);\n  console.log(\"1beforeEach\", meta.isTab);\n  if (getToken()) {\n    console.log(to);\n    console.log(\"2beforeEach\", to.query.name);\n    console.log(\"2beforeEach\", to.name);\n    console.log(\"2beforeEach\", meta.isTab);\n    if (store.getters.isLock && to.path !== lockPage) {\n      //如果系统激活锁屏，全部跳转到锁屏页\n      next({\n        path: lockPage\n      });\n    } else if (to.path === '/login') {\n      //如果登录成功访问登录页跳转到主页\n      next({\n        path: '/'\n      });\n    } else {\n      //如果用户信息为空则获取用户信息，获取用户信息失败，跳转到登录页\n      if (store.getters.token.length === 0) {\n        store.dispatch('FedLogOut').then(function () {\n          next({\n            path: '/login'\n          });\n        });\n      } else {\n        var value = to.query.src || to.fullPath;\n        var label = to.query.name || to.name;\n        var _meta = to.meta || router.$avueRouter.meta || {};\n        var i18n = to.query.i18n;\n        if (value.indexOf(\"edit\") != -1) {\n          label = label.replace(\"新增\", \"编辑\");\n        }\n        console.log(to);\n        console.log(\"3beforeEach\", to.query.name);\n        console.log(\"3beforeEach\", to.name);\n        console.log(\"3beforeEach\", _meta.isTab, value, label);\n        if (_meta.isTab !== false && !validatenull(value) && !validatenull(label)) {\n          store.commit('ADD_TAG', {\n            label: label,\n            value: value,\n            params: to.params,\n            query: to.query,\n            meta: function () {\n              if (!i18n) {\n                return _meta;\n              }\n              return {\n                i18n: i18n\n              };\n            }(),\n            group: router.$avueRouter.group || []\n          });\n        }\n        next();\n      }\n    }\n  } else {\n    // next({path: '/'})\n    //判断是否需要认证，没有登录访问去登录页\n    if (meta.isAuth === false) {\n      next();\n    } else {\n      next('/login');\n    }\n  }\n});\nrouter.afterEach(function () {\n  NProgress.done();\n  var title = store.getters.tag.label;\n  var i18n = store.getters.tag.meta.i18n;\n  title = router.$avueRouter.generateTitle(title, i18n);\n  //根据当前的标签也获取label的值动态设置浏览器标题\n  router.$avueRouter.setTitle(title);\n});",{"version":3,"names":["router","store","validatenull","getToken","NProgress","configure","showSpinner","lockPage","getters","website","beforeEach","to","from","next","meta","isMenu","menu","undefined","query","commit","console","log","name","isTab","isLock","path","token","length","dispatch","then","value","src","fullPath","label","$avueRouter","i18n","indexOf","replace","params","group","isAuth","afterEach","done","title","tag","generateTitle","setTitle"],"sources":["D:/转化仓库/e-adminSystem/src/permission.js"],"sourcesContent":["/**\r\n * 全站权限配置\r\n *\r\n */\r\nimport router from './router/router'\r\nimport store from './store'\r\nimport {validatenull} from '@/util/validate'\r\nimport {getToken} from '@/util/auth'\r\nimport NProgress from 'nprogress' // progress bar\r\nimport 'nprogress/nprogress.css' // progress bar style\r\nNProgress.configure({showSpinner: false});\r\nconst lockPage = store.getters.website.lockPage; //锁屏页\r\nrouter.beforeEach((to, from, next) => {\r\n  const meta = to.meta || {};\r\n  const isMenu = meta.menu === undefined ? to.query.menu : meta.menu;\r\n  store.commit('SET_IS_MENU', isMenu === undefined);\r\n  console.log(to)\r\n  console.log(\"1beforeEach\",to.query.name)\r\n  console.log(\"1beforeEach\",to.name)\r\n  console.log(\"1beforeEach\",meta.isTab)\r\n  if (getToken()) {\r\n    console.log(to)\r\n    console.log(\"2beforeEach\",to.query.name)\r\n    console.log(\"2beforeEach\",to.name)\r\n    console.log(\"2beforeEach\",meta.isTab)\r\n    if (store.getters.isLock && to.path !== lockPage) { //如果系统激活锁屏，全部跳转到锁屏页\r\n      next({path: lockPage})\r\n    } else if (to.path === '/login') { //如果登录成功访问登录页跳转到主页\r\n      next({path: '/'})\r\n    } else {\r\n      //如果用户信息为空则获取用户信息，获取用户信息失败，跳转到登录页\r\n      if (store.getters.token.length === 0) {\r\n        store.dispatch('FedLogOut').then(() => {\r\n          next({path: '/login'})\r\n        })\r\n      } else {\r\n        const value = to.query.src || to.fullPath;\r\n        let label = to.query.name || to.name;\r\n        const meta = to.meta || router.$avueRouter.meta || {};\r\n        const i18n = to.query.i18n;\r\n        if (value.indexOf(\"edit\")!=-1){\r\n          label = label.replace(\"新增\",\"编辑\");\r\n        }\r\n        console.log(to)\r\n        console.log(\"3beforeEach\",to.query.name)\r\n        console.log(\"3beforeEach\",to.name)\r\n        console.log(\"3beforeEach\",meta.isTab,value,label)\r\n        if (meta.isTab !== false && !validatenull(value) && !validatenull(label)) {\r\n          store.commit('ADD_TAG', {\r\n            label: label,\r\n            value: value,\r\n            params: to.params,\r\n            query: to.query,\r\n            meta: (() => {\r\n              if (!i18n) {\r\n                return meta\r\n              }\r\n              return {\r\n                i18n: i18n\r\n              }\r\n            })(),\r\n            group: router.$avueRouter.group || []\r\n          });\r\n        }\r\n        next()\r\n      }\r\n    }\r\n  } else {\r\n    // next({path: '/'})\r\n    //判断是否需要认证，没有登录访问去登录页\r\n    if (meta.isAuth === false) {\r\n      next()\r\n    } else {\r\n      next('/login')\r\n    }\r\n  }\r\n})\r\n\r\nrouter.afterEach(() => {\r\n  NProgress.done();\r\n  let title = store.getters.tag.label;\r\n  let i18n = store.getters.tag.meta.i18n;\r\n  title = router.$avueRouter.generateTitle(title, i18n)\r\n  //根据当前的标签也获取label的值动态设置浏览器标题\r\n  router.$avueRouter.setTitle(title);\r\n});\r\n"],"mappings":"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"}]}