{"remainingRequest":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workCode\\xiaoE\\大圣系统源码\\admin\\src\\views\\goods\\goods_info.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\src\\views\\goods\\goods_info.vue","mtime":1676445950000},{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678778409044},{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1678778390429},{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678778409044},{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1678778410194}],"contextDependencies":[],"result":["\n  import {getDetail} from \"@/api/goods/goods\";\n  import {categoryTree, getList} from \"../../api/goods/goodscategory\";\n  import {dictionary} from \"../../api/system/dict\";\n  import {getList as getExtraserviceList} from \"../../api/goods/extraservice\";\n  import {getList as getReturnAddressList} from \"../../api/goods/returnaddress\";\n  import {getAllList as getMaintaininfoList} from \"../../api/operation/maintaininfo\";\n  import {getAllList as getRentinfoList} from \"../../api/operation/rentinfo\";\n  import {Base64} from 'js-base64';\n  import {getToken} from '../../util/auth'\n  import website from '../../config/website';\n  import {\n    defaultBuyout,\n    defaultFlexible,\n    defaultPlanInfo,\n    defaultReturn,\n    goodsPlanInfo\n  } from \"../../constant/goods/constant\";\n  import {saveOrUpdate} from \"../../api/goods/goods\";\n\n  export default {\n    name: \"wel\",\n    data() {\n      return {\n        loading:false,\n        goodsId:null,\n        goodsInfo: {},\n        plans: [],\n        spanArr: [],\n        usePlan:0,\n        columns: [\"packageName\", \"specification1\", \"specification2\",\"specification3\",\"specification4\",\"specification5\"],\n        specifications:[],\n      }\n    },\n    watch: {\n    },\n    methods: {\n      photo(url){\n        return this.$store.state.common.cloudDomain+url;\n      },\n      checkNumber(val){\n        return parseFloat(val).toString() != \"NaN\";\n      },\n      calculateRentMoney(row){\n        console.log(row)\n        if (this.checkNumber(this.goodsInfo.totalPricesRate)&&this.checkNumber(row.websitePrice)&&this.checkNumber(row.rentRate)&&this.checkNumber(row.buyoutBalancePayment)){\n          var totalPricesRate = parseFloat(this.goodsInfo.totalPricesRate)\n          var websitePrice = parseFloat(row.websitePrice)\n          var rentRate = parseFloat(row.rentRate)\n          var buyoutBalancePayment = parseFloat(row.buyoutBalancePayment)\n          if (row.packageName.type == 1){\n            return (totalPricesRate*websitePrice*rentRate/12).toFixed(2)\n          } else if (row.packageName.type == 2){\n            return (totalPricesRate*websitePrice*rentRate/12).toFixed(2)\n          } else if (row.packageName.type == 3){\n            return ((totalPricesRate*websitePrice-buyoutBalancePayment)*rentRate/12).toFixed(2)\n          }\n        }\n        return \"\"\n      },\n      calculateBuyoutMoney(row){\n        console.log(row)\n        if (this.checkNumber(this.goodsInfo.totalPricesRate)&&this.checkNumber(row.websitePrice)&&this.checkNumber(row.rentRate)&&this.checkNumber(row.miniLease)&&this.checkNumber(row.buyoutBalancePayment)){\n          var totalPricesRate = parseFloat(this.goodsInfo.totalPricesRate)//总价系数\n          var websitePrice = parseFloat(row.websitePrice)//官网价\n          var rentRate = parseFloat(row.rentRate)//租金系数\n          var miniLease = parseFloat(row.miniLease)//最低租期\n          var buyoutBalancePayment = parseFloat(row.buyoutBalancePayment)\n          if (row.packageName.type == 1){\n            return (totalPricesRate*websitePrice - (totalPricesRate*websitePrice*rentRate)).toFixed(2)\n          } else if (row.packageName.type == 2){\n            return (totalPricesRate*websitePrice - (totalPricesRate*websitePrice*rentRate)).toFixed(2)\n          } else if (row.packageName.type == 3){\n            return (totalPricesRate*websitePrice-((totalPricesRate*websitePrice-buyoutBalancePayment)*rentRate/12*miniLease)+buyoutBalancePayment).toFixed(2)\n          }\n        }\n        return \"\"\n      },\n      calculateLateFeeMoney(row){\n        if (this.checkNumber(this.goodsInfo.totalPricesRate)&&this.checkNumber(row.websitePrice)&&this.checkNumber(row.rentRate)&&this.checkNumber(row.buyoutBalancePayment)&&this.checkNumber(row.lateFeeMoney)){\n          var totalPricesRate = parseFloat(this.goodsInfo.totalPricesRate)\n          var websitePrice = parseFloat(row.websitePrice)\n          var rentRate = parseFloat(row.rentRate)\n          var lateFeeMoney = parseFloat(row.lateFeeMoney)\n          var buyoutBalancePayment = parseFloat(row.buyoutBalancePayment)\n          if (row.packageName.type == 1){\n            return (totalPricesRate*websitePrice/365*lateFeeMoney).toFixed(2)\n          } else if (row.packageName.type == 2){\n            return (totalPricesRate*websitePrice/365*lateFeeMoney).toFixed(2)\n          } else if (row.packageName.type == 3){\n            return (totalPricesRate*websitePrice/365*lateFeeMoney).toFixed(2)\n          }\n        }\n      },\n      headerClassName({row, column, rowIndex, columnIndex}) {\n        return \"head-class\"\n      },\n      spanMethod({row, column, rowIndex, columnIndex}) {\n        if (!this.spanArr||this.spanArr.length == 0){\n          return {\n            rowspan: 1,\n            colspan: 1\n          }\n        }\n        const _row = this.spanArr[Number.parseInt(rowIndex)][column.property];\n        console.log(_row)\n        const _col = _row > 0 ? 1 : 0;\n        return {\n          rowspan: _row,\n          colspan: _col\n        }\n      },\n      rowspan() {\n        // this.spanArr = [[3,2,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]\n        this.spanArr.splice(0);\n        var proKeys = \"\";\n        this.plans.forEach((item, index) => {\n          var data = {\n            \"packageName\": 1,\n            \"stockout\": 1,\n            \"inventory\": 1,\n            \"websitePrice\": 1,\n            \"premiumMoney\": 1,\n            \"rentRate\": 1,\n            \"depositMoney\": 1,\n            \"miniLease\": 1,\n            \"rentMoney\": 1,\n            \"buyoutMoney\": 1,\n            \"lateFeeMoney\": 1\n          };\n          console.log(\"======\",item)\n          var items = [];\n          for (let index  in  this.specifications){\n            var  one = this.specifications[index]\n            if (one.name&&one.name.length>0&&one.isGroup == true){\n              items.push(one.attr)\n            }\n          }\n          this.usePlan = items.length;\n          for (let i = 0; i < this.usePlan; i++) {\n            data['specification'+(i+1)] = 1\n          }\n          this.spanArr.push(data)\n\n          Object.keys(item).forEach((second, index2) => {\n            if (this.columns.indexOf(second) != -1)\n              proKeys = proKeys + item[second].name;\n          })\n          if (index > 0) {\n            var keys = \"\";\n            Object.keys(item).forEach((second, index2) => {\n              if (this.columns.indexOf(second) != -1) {\n                keys = keys + item[second].name;\n                if (this.plans[index][second].name === this.plans[index - 1][second].name && proKeys.startsWith(keys)) {\n                  for (let i = index; i > 0; i--) {\n                    if (this.spanArr[i - 1][second] != 0) {\n                      this.spanArr[i - 1][second] += 1;\n                      break;\n                    }\n                  }\n                  this.spanArr[index][second] = 0;\n                } else {\n                  this.spanArr[index][second] = 1;\n                }\n              }\n            })\n            proKeys = keys;\n          }\n        })\n        console.log(\"++\",this.spanArr)\n      },\n    },\n    mounted() {\n\n    },\n    computed: {\n      option: function (){\n        var option = {\n          rowKey:'rowKey',\n          addBtn: false,\n          searchBtn: false,\n          border: true,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          editBtn:false,\n          addRowBtn:false,\n          cellBtn:false,\n          cancelBtn:false,\n          headerAlign: 'center',\n          align: 'center',\n          menu:false,\n          column: []\n        }\n        option.column.push( {width: 100,label: '套餐',prop: 'packageName',cell: true,slot: true,})\n        var number = 0;\n        for (let index in this.specifications) {\n          var item = this.specifications[index]\n          if (item.name&&item.name.length>0&&item.isGroup == true){\n            option.column.push( { label: item.name, prop: 'specification'+(number+1), slot: true, cell: true })\n            number = number+1;\n          }\n        }\n        option.column.push( { label: '缺货', width: 60, prop: 'stockout', type: 'switch', slot: true, cell: true })\n        option.column.push( { label: '库存(件)', width: 100, prop: 'inventory', cell: true, rules: [ { required: true, message: '请输入库存', trigger: 'blur' } ] })\n        option.column.push( { label: '官网价', width: 60, prop: 'websitePrice', slot: true, })\n        option.column.push( { label: '溢价金', prop: 'premiumMoney', cell: true, rules: [ { required: true, message: '请输入姓名', trigger: 'blur' } ] })\n        option.column.push( { label: '租金系数', prop: 'rentRate', cell: true, rules: [ { required: true, message: '请输入姓名', trigger: 'blur' } ] })\n//        option.column.push( { label: '押金', prop: 'depositMoney', cell: true, rules: [ { required: true, message: '请输入姓名', trigger: 'blur' } ] })\n        option.column.push( { label: '最低月数', width: 70, prop: 'miniLease', slot: true, })\n        option.column.push( { label: '单期租金', width: 70, prop: 'rentMoney', slot: true, })\n        option.column.push( { label: '买断尾款', width: 70, prop: 'buyoutMoney', slot: true, })\n        option.column.push( { label: '滞纳金(日租金%)', width: 120, prop: 'lateFeeMoney', slot: true, })\n        option.column.push( { label: '操作', width: 100, prop: 'menu', slot: true, })\n        return option\n      },\n    },\n\n    created() {\n      this.loading = true;\n      this.goodsId=this.$route.query.goodsId;\n      getDetail(this.goodsId).then(res => {\n        this.goodsInfo = res.data.data;\n        console.log(this.goodsInfo.combinationsJsonData)\n        this.plans = JSON.parse(this.goodsInfo.combinationsJsonData)\n        this.specifications = JSON.parse(this.goodsInfo.goodsSpecificationsJsonData)\n        for (const item of this.plans) {\n          item.$cellEdit=false\n        }\n        this.rowspan()\n        this.table_key = new Date().getTime();\n        console.log(\"-----\")\n        console.log(this.specifications)\n        console.log(this.plans)\n        console.log(\"=====\")\n        this.loading = false;\n      });\n    }\n  };\n",{"version":3,"sources":["goods_info.vue"],"names":[],"mappings":";AAoJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"goods_info.vue","sourceRoot":"src/views/goods","sourcesContent":["<template>\n  <div style=\"height: 100%;\">\n    <div v-loading=\"loading\" style=\"height:100%;width:100%;z-index: 100;position: absolute\" v-if=\"loading\"></div>\n    <div>\n      <el-form ref=\"form1\" :model=\"sales\" label-width=\"120px\" size=\"small\">\n        <el-card class=\"basis-info\" style=\"margin-top: 0px !important;\">\n          <div slot=\"header\" class=\"clearfix\">\n            <span>基础信息</span>\n          </div>\n          <div class=\"form-view\" style=\"width: 1000px;\">\n            <el-row>\n              <el-col :span=\"8\">\n                <img :src=\"photo(goodsInfo.photoCover)\" style=\"width: 100%;height: auto;\"/>\n              </el-col>\n              <el-col :span=\"16\">\n                <div class=\"goods_info\" >\n                  <el-form-item label=\"商品标题：\" prop=\"userNameCn\">\n                    {{goodsInfo.title}}\n                  </el-form-item>\n                  <el-form-item label=\"状态：\" prop=\"userNameCn\">\n                    {{goodsInfo.statusName}}\n                  </el-form-item>\n                  <el-form-item label=\"商品类目：\" prop=\"userNameCn\">\n                    {{goodsInfo.tags}}\n                  </el-form-item>\n                  <el-form-item label=\"营销语句：\" >\n                    {{goodsInfo.marketing}}\n                  </el-form-item>\n                  <el-form-item label=\"商品成色：\" prop=\"userNameCn\">\n                    {{goodsInfo.secondHand}}\n                  </el-form-item>\n                  <el-form-item label=\"类目标签：\" >\n                    {{goodsInfo.category}}\n                  </el-form-item>\n                  <el-form-item label=\"库存(件)：\" >\n                    {{goodsInfo.inventory==0?\"暂无库存\":goodsInfo.inventory}}\n                  </el-form-item>\n                  <el-form-item label=\"营销角标：\" >\n                    {{goodsInfo.marketingCornerMark}}\n                  </el-form-item>\n                  <el-form-item label=\"增值服务：\" prop=\"userNameCn\">\n                    {{goodsInfo.extraServiceName}}\n                  </el-form-item>\n                  <el-form-item label=\"归还地址：\" prop=\"userNameCn\">\n                    {{goodsInfo.address}}\n                  </el-form-item>\n                  <el-form-item label=\"租赁说明：\" prop=\"userNameCn\">\n                    {{goodsInfo.rentInfo}}\n                  </el-form-item>\n                  <el-form-item label=\"售后维修说明：\" prop=\"userNameCn\">\n                    {{goodsInfo.maintainInfo}}\n                  </el-form-item>\n                  <el-form-item label=\"添加时间：\" >\n                    {{goodsInfo.createTime}}\n                  </el-form-item>\n                </div>\n              </el-col>\n            </el-row>\n          </div>\n        </el-card>\n        <el-card class=\"basis-info\" style=\"margin-top: 10px !important;\">\n          <div slot=\"header\" class=\"clearfix\">\n            <span>销售规格</span>\n          </div>\n          <div>\n            <avue-crud :key=\"table_key\"  ref=\"crud\" :option=\"option\" :data=\"plans\"\n                       :header-cell-class-name=\"headerClassName\" :span-method=\"spanMethod\" @row-update=\"addUpdate\"\n                       @row-save=\"rowSave\" @row-click=\"handleRowClick\" :cell-class-name=\"cellClassName\">\n              <template slot=\"packageName\" slot-scope=\"scope\">\n                <el-tag>{{ scope.label.name }}</el-tag>\n              </template>\n              <!--        规格名称-->\n              <template slot=\"specification1\" slot-scope=\"scope\">\n                <el-tag>{{ scope.label.name }}</el-tag>\n              </template>\n              <!--        规格名称-->\n              <template slot=\"specification2\" slot-scope=\"scope\">\n                <el-tag>{{ scope.label.name }}</el-tag>\n              </template>\n              <!--        规格名称-->\n              <template slot=\"specification3\" slot-scope=\"scope\">\n                <el-tag>{{ scope.label.name }}</el-tag>\n              </template>\n              <!--        规格名称-->\n              <template slot=\"specification4\" slot-scope=\"scope\">\n                <el-tag>{{ scope.label.name }}</el-tag>\n              </template>\n              <!--        规格名称-->\n              <template slot=\"specification5\" slot-scope=\"scope\">\n                <el-tag>{{ scope.label.name }}</el-tag>\n              </template>\n              <!--        官网价-->\n              <template slot=\"websitePrice\" slot-scope=\"scope\">\n                <span>{{ scope.label }}</span>\n              </template>\n              <!--        最低租期-->\n              <template slot=\"miniLease\" slot-scope=\"scope\">\n                <span>{{ scope.label }}</span>\n              </template>\n\n              <!--        每一期租金-->\n              <template slot=\"stockout\" slot-scope=\"scope\">\n                <span>{{ scope.label?\"是\":\"否\"}}</span>\n              </template>\n\n              <!--        每一期租金-->\n              <template slot=\"rentMoney\" slot-scope=\"scope\">\n                <span>{{ calculateRentMoney(scope.row) }}</span>\n              </template>\n              <!--        买断尾款-->\n              <template slot=\"buyoutMoney\" slot-scope=\"scope\">\n                <span>{{ calculateBuyoutMoney(scope.row) }}</span>\n              </template>\n              <!--        滞纳金-->\n              <template slot=\"lateFeeMoney\" slot-scope=\"scope\">\n                <span>{{ calculateLateFeeMoney(scope.row) }}</span>\n              </template>\n              <template slot=\"inventory\" slot-scope=\"scope\">\n           <span>\n              {{scope.row.inventory==0?\"暂无库存\":scope.row.inventory}}\n           </span>\n              </template>\n            </avue-crud>\n          </div>\n        </el-card>\n        <el-card class=\"basis-info\" style=\"margin-top: 10px !important;\">\n          <div slot=\"header\" class=\"clearfix\">\n            <span>详情</span>\n          </div>\n          <div>\n            <el-form-item label=\"轮播图片：\" prop=\"userNameCn\">\n              <div style=\"display: inline\" v-if=\"goodsInfo.photoSlideshow\" v-for=\"item in goodsInfo.photoSlideshow.split(',')\">\n                <img :src=\"photo(item)\" style=\"width: 200px;height: auto;\"/>\n              </div>\n            </el-form-item>\n            <el-form-item label=\"详情图片：\" prop=\"userNameCn\">\n              <div style=\"display: inline\" v-if=\"goodsInfo.photoDetails\" v-for=\"item in goodsInfo.photoDetails.split(',')\">\n                <img :src=\"photo(item)\" style=\"width: 200px;height: auto;\"/>\n              </div>\n            </el-form-item>\n          </div>\n        </el-card>\n      </el-form>\n    </div>\n  </div>\n</template>\n\n<script>\n  import {getDetail} from \"@/api/goods/goods\";\n  import {categoryTree, getList} from \"../../api/goods/goodscategory\";\n  import {dictionary} from \"../../api/system/dict\";\n  import {getList as getExtraserviceList} from \"../../api/goods/extraservice\";\n  import {getList as getReturnAddressList} from \"../../api/goods/returnaddress\";\n  import {getAllList as getMaintaininfoList} from \"../../api/operation/maintaininfo\";\n  import {getAllList as getRentinfoList} from \"../../api/operation/rentinfo\";\n  import {Base64} from 'js-base64';\n  import {getToken} from '../../util/auth'\n  import website from '../../config/website';\n  import {\n    defaultBuyout,\n    defaultFlexible,\n    defaultPlanInfo,\n    defaultReturn,\n    goodsPlanInfo\n  } from \"../../constant/goods/constant\";\n  import {saveOrUpdate} from \"../../api/goods/goods\";\n\n  export default {\n    name: \"wel\",\n    data() {\n      return {\n        loading:false,\n        goodsId:null,\n        goodsInfo: {},\n        plans: [],\n        spanArr: [],\n        usePlan:0,\n        columns: [\"packageName\", \"specification1\", \"specification2\",\"specification3\",\"specification4\",\"specification5\"],\n        specifications:[],\n      }\n    },\n    watch: {\n    },\n    methods: {\n      photo(url){\n        return this.$store.state.common.cloudDomain+url;\n      },\n      checkNumber(val){\n        return parseFloat(val).toString() != \"NaN\";\n      },\n      calculateRentMoney(row){\n        console.log(row)\n        if (this.checkNumber(this.goodsInfo.totalPricesRate)&&this.checkNumber(row.websitePrice)&&this.checkNumber(row.rentRate)&&this.checkNumber(row.buyoutBalancePayment)){\n          var totalPricesRate = parseFloat(this.goodsInfo.totalPricesRate)\n          var websitePrice = parseFloat(row.websitePrice)\n          var rentRate = parseFloat(row.rentRate)\n          var buyoutBalancePayment = parseFloat(row.buyoutBalancePayment)\n          if (row.packageName.type == 1){\n            return (totalPricesRate*websitePrice*rentRate/12).toFixed(2)\n          } else if (row.packageName.type == 2){\n            return (totalPricesRate*websitePrice*rentRate/12).toFixed(2)\n          } else if (row.packageName.type == 3){\n            return ((totalPricesRate*websitePrice-buyoutBalancePayment)*rentRate/12).toFixed(2)\n          }\n        }\n        return \"\"\n      },\n      calculateBuyoutMoney(row){\n        console.log(row)\n        if (this.checkNumber(this.goodsInfo.totalPricesRate)&&this.checkNumber(row.websitePrice)&&this.checkNumber(row.rentRate)&&this.checkNumber(row.miniLease)&&this.checkNumber(row.buyoutBalancePayment)){\n          var totalPricesRate = parseFloat(this.goodsInfo.totalPricesRate)//总价系数\n          var websitePrice = parseFloat(row.websitePrice)//官网价\n          var rentRate = parseFloat(row.rentRate)//租金系数\n          var miniLease = parseFloat(row.miniLease)//最低租期\n          var buyoutBalancePayment = parseFloat(row.buyoutBalancePayment)\n          if (row.packageName.type == 1){\n            return (totalPricesRate*websitePrice - (totalPricesRate*websitePrice*rentRate)).toFixed(2)\n          } else if (row.packageName.type == 2){\n            return (totalPricesRate*websitePrice - (totalPricesRate*websitePrice*rentRate)).toFixed(2)\n          } else if (row.packageName.type == 3){\n            return (totalPricesRate*websitePrice-((totalPricesRate*websitePrice-buyoutBalancePayment)*rentRate/12*miniLease)+buyoutBalancePayment).toFixed(2)\n          }\n        }\n        return \"\"\n      },\n      calculateLateFeeMoney(row){\n        if (this.checkNumber(this.goodsInfo.totalPricesRate)&&this.checkNumber(row.websitePrice)&&this.checkNumber(row.rentRate)&&this.checkNumber(row.buyoutBalancePayment)&&this.checkNumber(row.lateFeeMoney)){\n          var totalPricesRate = parseFloat(this.goodsInfo.totalPricesRate)\n          var websitePrice = parseFloat(row.websitePrice)\n          var rentRate = parseFloat(row.rentRate)\n          var lateFeeMoney = parseFloat(row.lateFeeMoney)\n          var buyoutBalancePayment = parseFloat(row.buyoutBalancePayment)\n          if (row.packageName.type == 1){\n            return (totalPricesRate*websitePrice/365*lateFeeMoney).toFixed(2)\n          } else if (row.packageName.type == 2){\n            return (totalPricesRate*websitePrice/365*lateFeeMoney).toFixed(2)\n          } else if (row.packageName.type == 3){\n            return (totalPricesRate*websitePrice/365*lateFeeMoney).toFixed(2)\n          }\n        }\n      },\n      headerClassName({row, column, rowIndex, columnIndex}) {\n        return \"head-class\"\n      },\n      spanMethod({row, column, rowIndex, columnIndex}) {\n        if (!this.spanArr||this.spanArr.length == 0){\n          return {\n            rowspan: 1,\n            colspan: 1\n          }\n        }\n        const _row = this.spanArr[Number.parseInt(rowIndex)][column.property];\n        console.log(_row)\n        const _col = _row > 0 ? 1 : 0;\n        return {\n          rowspan: _row,\n          colspan: _col\n        }\n      },\n      rowspan() {\n        // this.spanArr = [[3,2,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]\n        this.spanArr.splice(0);\n        var proKeys = \"\";\n        this.plans.forEach((item, index) => {\n          var data = {\n            \"packageName\": 1,\n            \"stockout\": 1,\n            \"inventory\": 1,\n            \"websitePrice\": 1,\n            \"premiumMoney\": 1,\n            \"rentRate\": 1,\n            \"depositMoney\": 1,\n            \"miniLease\": 1,\n            \"rentMoney\": 1,\n            \"buyoutMoney\": 1,\n            \"lateFeeMoney\": 1\n          };\n          console.log(\"======\",item)\n          var items = [];\n          for (let index  in  this.specifications){\n            var  one = this.specifications[index]\n            if (one.name&&one.name.length>0&&one.isGroup == true){\n              items.push(one.attr)\n            }\n          }\n          this.usePlan = items.length;\n          for (let i = 0; i < this.usePlan; i++) {\n            data['specification'+(i+1)] = 1\n          }\n          this.spanArr.push(data)\n\n          Object.keys(item).forEach((second, index2) => {\n            if (this.columns.indexOf(second) != -1)\n              proKeys = proKeys + item[second].name;\n          })\n          if (index > 0) {\n            var keys = \"\";\n            Object.keys(item).forEach((second, index2) => {\n              if (this.columns.indexOf(second) != -1) {\n                keys = keys + item[second].name;\n                if (this.plans[index][second].name === this.plans[index - 1][second].name && proKeys.startsWith(keys)) {\n                  for (let i = index; i > 0; i--) {\n                    if (this.spanArr[i - 1][second] != 0) {\n                      this.spanArr[i - 1][second] += 1;\n                      break;\n                    }\n                  }\n                  this.spanArr[index][second] = 0;\n                } else {\n                  this.spanArr[index][second] = 1;\n                }\n              }\n            })\n            proKeys = keys;\n          }\n        })\n        console.log(\"++\",this.spanArr)\n      },\n    },\n    mounted() {\n\n    },\n    computed: {\n      option: function (){\n        var option = {\n          rowKey:'rowKey',\n          addBtn: false,\n          searchBtn: false,\n          border: true,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          editBtn:false,\n          addRowBtn:false,\n          cellBtn:false,\n          cancelBtn:false,\n          headerAlign: 'center',\n          align: 'center',\n          menu:false,\n          column: []\n        }\n        option.column.push( {width: 100,label: '套餐',prop: 'packageName',cell: true,slot: true,})\n        var number = 0;\n        for (let index in this.specifications) {\n          var item = this.specifications[index]\n          if (item.name&&item.name.length>0&&item.isGroup == true){\n            option.column.push( { label: item.name, prop: 'specification'+(number+1), slot: true, cell: true })\n            number = number+1;\n          }\n        }\n        option.column.push( { label: '缺货', width: 60, prop: 'stockout', type: 'switch', slot: true, cell: true })\n        option.column.push( { label: '库存(件)', width: 100, prop: 'inventory', cell: true, rules: [ { required: true, message: '请输入库存', trigger: 'blur' } ] })\n        option.column.push( { label: '官网价', width: 60, prop: 'websitePrice', slot: true, })\n        option.column.push( { label: '溢价金', prop: 'premiumMoney', cell: true, rules: [ { required: true, message: '请输入姓名', trigger: 'blur' } ] })\n        option.column.push( { label: '租金系数', prop: 'rentRate', cell: true, rules: [ { required: true, message: '请输入姓名', trigger: 'blur' } ] })\n//        option.column.push( { label: '押金', prop: 'depositMoney', cell: true, rules: [ { required: true, message: '请输入姓名', trigger: 'blur' } ] })\n        option.column.push( { label: '最低月数', width: 70, prop: 'miniLease', slot: true, })\n        option.column.push( { label: '单期租金', width: 70, prop: 'rentMoney', slot: true, })\n        option.column.push( { label: '买断尾款', width: 70, prop: 'buyoutMoney', slot: true, })\n        option.column.push( { label: '滞纳金(日租金%)', width: 120, prop: 'lateFeeMoney', slot: true, })\n        option.column.push( { label: '操作', width: 100, prop: 'menu', slot: true, })\n        return option\n      },\n    },\n\n    created() {\n      this.loading = true;\n      this.goodsId=this.$route.query.goodsId;\n      getDetail(this.goodsId).then(res => {\n        this.goodsInfo = res.data.data;\n        console.log(this.goodsInfo.combinationsJsonData)\n        this.plans = JSON.parse(this.goodsInfo.combinationsJsonData)\n        this.specifications = JSON.parse(this.goodsInfo.goodsSpecificationsJsonData)\n        for (const item of this.plans) {\n          item.$cellEdit=false\n        }\n        this.rowspan()\n        this.table_key = new Date().getTime();\n        console.log(\"-----\")\n        console.log(this.specifications)\n        console.log(this.plans)\n        console.log(\"=====\")\n        this.loading = false;\n      });\n    }\n  };\n</script>\n\n<style scoped=\"scoped\" lang=\"scss\">\n  .goods_info :deep .el-form-item {\n   margin-bottom: 0px;\n   }\n  .top-bar-title {\n    height: 40px;\n    background-color: white;\n    padding: 15px 20px 15px 20px;\n    margin-left: 6px;\n    margin-right: 6px;\n    display: flex;\n    justify-content: space-between;\n    border-bottom: 2px solid #F0F2F5;\n  }\n\n  .basis-info {\n    margin-top: 10px;\n    margin-left: 6px;\n    margin-right: 6px;\n  }\n\n  .basis-info .text {\n    font-size: 14px;\n  }\n\n  .basis-info .item {\n    margin-bottom: 18px;\n  }\n\n  :deep .el-card__header {\n    padding: 18px 20px !important;\n  }\n\n  .basis-info .clearfix:before,\n  .basis-info .clearfix:after {\n    display: table;\n    content: \"\";\n  }\n\n  .basis-info .clearfix:after {\n    clear: both\n  }\n\n  .form-view :deep .el-select {\n    width: 100%;\n  }\n\n  .form-view .el-tag + .el-tag {\n    margin-left: 10px;\n  }\n\n  .form-view .button-new-tag {\n    margin-left: 10px;\n    height: 32px;\n    line-height: 30px;\n    padding-top: 0;\n    padding-bottom: 0;\n  }\n\n  .form-view .input-new-tag {\n    width: 90px;\n    margin-left: 10px;\n    vertical-align: bottom;\n  }\n\n  .has-background {\n    width: calc(100% - 20px);\n    background-color: #F2F2F260;\n  }\n\n  .has-background-item {\n    margin: 20px 10px 20px 10px;\n    display: block;\n  }\n\n  .no-background {\n    width: calc(100% - 20px);\n    padding: 5px 10px 5px 10px;\n  }\n\n  .form-input-3 {\n    width: 150px\n  }\n\n  .form-input-title {\n    margin-left: 20px;\n    margin-right: 10px\n  }\n\n  .form-select-2 {\n    width: 330px !important;\n  }\n\n  .form-plan-notice {\n    margin-left: 10px;\n    color: #D9001B\n  }\n\n  :deep .avue-crud__menu {\n    display: none;\n  }\n\n  :deep .head-class {\n    background-color: white !important;\n  }\n\n</style>\n"]}]}