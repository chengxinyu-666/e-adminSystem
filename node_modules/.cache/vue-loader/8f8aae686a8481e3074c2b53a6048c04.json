{"remainingRequest":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workCode\\xiaoE\\大圣系统源码\\admin\\src\\components\\order\\dialog_receive_goods.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\src\\components\\order\\dialog_receive_goods.vue","mtime":1673871840000},{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678778409044},{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1678778390429},{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678778409044},{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1678778410194}],"contextDependencies":[],"result":["\n  import {add} from \"../../api/express/sendgoods\";\n  import {combinationTitle} from \"../../util/order\";\n  import vue from '@/main'\n  import {headers} from \"../../util/auth\";\n  import ElImageViewer from \"element-ui/packages/image/src/image-viewer\";\n  import {update} from \"../../api/express/receivegoods\";\n  import {cancle} from \"../../api/order/order\";\n\n  export default {\n    name: \"\",\n    components: {\n      ElImageViewer,\n    },\n    watch: {\n      tableData:{\n        handler:function(newValue,oldValue){\n         this.form.destroyJson = JSON.stringify(this.tableData)\n        },\n        immediate:false,\n        deep:true\n      },\n      isShow(val, oldVal) {\n        if (!val){\n          this.$nextTick(() => {\n            this.end(true);\n          })\n        }\n      }\n    },\n    data(){\n      return {\n        form:{\n          goodsTitle:null,\n          goodsSn:null,\n          sendVoucher:null,\n          destroyJson:null,\n          receivedVoucher:null\n        },\n        tableData: [],\n        table:{\n          menu:true,\n          editBtn:false,\n          delBtn:false,\n          dialogType:'drawer',\n          dialogWidth:300,\n          column:[\n            {\n              label:'部位',\n              prop:'where',\n              span: 24,\n              rules: [{\n                required: true,\n                message: \"请输入收货说明\",\n                trigger: \"blur\"\n              }]\n            }, {\n              label:'详细描述',\n              prop:'info',\n              type:'textarea',\n              span: 24,\n              rules: [{\n                required: true,\n                message: \"请输入收货说明\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        },\n        param:null,\n        isShow:false,\n        imagesList:[],\n        showViewer:false,\n        srcList:[],\n        expressList:[],\n        domain:vue.$store.state.common.cloudDomain,\n        loading:false,\n        dialogVisible:false,\n        option:{\n          submitBtn:false,\n          emptyBtn:false,\n          labelWidth: 120,\n          column: [\n            {\n              label:'商品名称型号',\n              prop:'goodsTitle',\n              span: 24,\n              type:'title',\n            },{\n              label:'SN/IME码',\n              prop:'goodsSn',\n              span: 24,\n              type:'title',\n            },{\n              label:'寄回凭证',\n              prop:'sendVoucher',\n              span: 24,\n              type:'title',\n            },{\n              label:'收货SN',\n              prop:'receiveSn',\n              span: 12,\n              type:'input',\n              rules: [{\n                required: true,\n                message: \"请输入收货SN\",\n                trigger: \"blur\"\n              }]\n            },{\n              label:'收货IME',\n              prop:'receiveIme',\n              span: 12,\n              type:'input',\n              rules: [{\n                required: true,\n                message: \"请输入收货IME\",\n                trigger: \"blur\"\n              }]\n            },{\n              label:'收货凭证',\n              prop:'receivedVoucher',\n              type: 'upload',\n              span: 24,\n              listType: 'picture-card',\n              tip: '只能上传jpg/png文件，且不超过500kb',\n              propsHttp: {\n                home: vue.$store.state.common.cloudDomain,\n                res: \"data\",\n                url: 'name',\n                name: 'originalName'\n              },\n              action: '/api/blade-resource/oss/endpoint/put-file',\n              rules: [{\n                required: true,\n                message: \"请上传收货凭证\",\n                trigger: \"blur\"\n              }]\n            },{\n              label:'收货说明',\n              span: 24,\n              type:'textarea',\n              minRows:3,\n              maxRows:5,\n              prop:'note',\n              rules: [{\n                required: true,\n                message: \"请输入收货说明\",\n                trigger: \"blur\"\n              }]\n            },{\n              label:'损坏情况',\n              prop:'destroyJson',\n              span: 24,\n              type:'title',\n              rules: [{\n                required: true,\n                message: \"请完善损坏情况\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        }\n      }\n    },\n    created () {\n    },\n    computed: {\n      headers(){\n        return headers()\n      },\n    },\n    activated () { },\n    mounted() {\n      if (this.param.returnSendVoucher){\n        var list = this.param.returnSendVoucher.split(\",\")\n        for (const item of list) {\n          this.imagesList.push(this.domain+item)\n        }\n      }\n    },\n    methods:{\n      handleRowClick (row, event, column) {\n        this.$refs.crud.rowEdit(row,row.$index);\n      },\n      handleRowSave(row,done,loading){\n        console.log(row)\n        row.file = null;\n        row.image = null;\n        this.tableData.push(row)\n        done()\n      },\n      handleRowUpdate(row,index,done,loading){\n        this.tableData[index].file = row.file\n        this.tableData[index].image = row.image\n        this.tableData[index].where = row.where\n        this.tableData[index].info = row.info\n        done()\n      },\n      viewImage(){\n        this.showViewer = true;\n      },\n      handleAvatarSuccess(res, file,scope) {\n        console.log(res,scope)\n        this.tableData[scope.$index].file = res.data.name\n        this.tableData[scope.$index].image = res.data.link\n        this.srcList = [];\n        this.srcList.push(res.data.link)\n        // this.$forceUpdate()\n      },\n      getCombinationTitle(val){\n        return combinationTitle(val);\n      },\n      closeFn () {\n        this.isShow = false\n        this.$nextTick(() => {\n          this.end(false);\n        })\n      },\n      cancle () {\n        this.isShow = false\n        this.$nextTick(() => {\n          this.end(false);\n        })\n      },\n      submit(type){\n        this.$refs.form.validate((valid, done,msg) => {\n          if (valid) {\n            var params = {...this.form}\n            params.orderId = this.param.id;\n            params.id = this.param.receiveId;\n            params.status = type;\n            params.goodsSn = params.receiveSn\n            params.goodsIme = params.receiveIme\n            params.receivedVoucher = params.receivedVoucher.join(\",\");\n            console.log(params)\n            update(params).then(res => {\n              vue.$message({\n                type: 'success',\n                message: '操作成功!'\n              });\n              this.isShow = false;\n            }).catch(res => {\n            });\n          } else {\n            return false;\n          }\n        })\n      },\n    }\n  }\n",{"version":3,"sources":["dialog_receive_goods.vue"],"names":[],"mappings":";AA+DA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dialog_receive_goods.vue","sourceRoot":"src/components/order","sourcesContent":["<template>\n  <div style=\"height: 100%;\">\n    <el-dialog\n      v-if=\"isShow\"\n      v-model=\"form\"\n      title=\"收货确认\"\n      :visible.sync=\"isShow\"\n      width=\"800px\"\n      @close=\"closeFn\"\n      append-to-body\n      style=\"text-align: left\">\n      <avue-form ref=\"form\" class=\"bill_info\" v-model=\"form\" :option=\"option\" @submit=\"submit\" @reset-change=\"cancle\">\n        <template slot-scope=\"{disabled,size}\" slot=\"goodsTitle\">\n          {{param.goodsTitle+getCombinationTitle(param.goodsCombinationJson)}}\n        </template>\n        <template slot-scope=\"{disabled,size}\" slot=\"goodsSn\">\n          {{param.goodsSn+\"/\"+param.goodsIme}}\n        </template>\n        <template slot-scope=\"{disabled,size}\" slot=\"sendVoucher\">\n          <el-image\n            v-for=\"image in imagesList\"\n            style=\"width: 100px; height: 100px;margin-left: 10px\"\n            :src=\"image\"\n            :preview-src-list=\"imagesList\">\n          </el-image>\n        </template>\n        <template slot-scope=\"{disabled,size}\" slot=\"destroyJson\">\n          <avue-crud ref=\"crud\" :data=\"tableData\" :option=\"table\" @row-dblclick=\"handleRowClick\"  @row-save=\"handleRowSave\" @row-update=\"handleRowUpdate\">\n            <template #menu=\"{row,index,size}\">\n              <div style=\"display: inline-flex\">\n                <el-button type=\"primary\" v-if=\"row.image\" style=\"margin-right: 5px;\" icon=\"el-icon-view\"  @click=\"viewImage()\">查看附件</el-button>\n                <el-upload\n                  class=\"upload-demo\"\n                  :headers=\"headers\"\n                  :show-file-list=\"false\"\n                  :on-success=\"function (res, file){return handleAvatarSuccess(res, file, row)}\"\n                  action=\"/api/blade-resource/oss/endpoint/put-file\">\n                  <el-button size=\"small\" type=\"primary\">{{row.image?\"替换附件\":\"添加附件\"}}</el-button>\n                </el-upload>\n              </div>\n            </template>\n          </avue-crud>\n        </template>\n\n        <template slot-scope=\"{size}\" slot=\"menuForm\">\n          <div slot=\"footer\" class=\"dialog-footer\" style=\"text-align: end;\">\n            <el-button size=\"medium\" @click=\"$refs.form.resetForm()\">取 消</el-button>\n            <el-button size=\"medium\" type=\"primary\"  @click=\"submit(5)\">通 过</el-button>\n            <el-button size=\"medium\" type=\"danger\"  @click=\"submit(6)\">驳 回</el-button>\n          </div>\n        </template>\n      </avue-form>\n      <el-image-viewer\n        class=\"imageview\"\n        v-if=\"showViewer\"\n        :on-close=\"() => {showViewer = false;}\"\n        :url-list=\"srcList\">\n      </el-image-viewer>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n  import {add} from \"../../api/express/sendgoods\";\n  import {combinationTitle} from \"../../util/order\";\n  import vue from '@/main'\n  import {headers} from \"../../util/auth\";\n  import ElImageViewer from \"element-ui/packages/image/src/image-viewer\";\n  import {update} from \"../../api/express/receivegoods\";\n  import {cancle} from \"../../api/order/order\";\n\n  export default {\n    name: \"\",\n    components: {\n      ElImageViewer,\n    },\n    watch: {\n      tableData:{\n        handler:function(newValue,oldValue){\n         this.form.destroyJson = JSON.stringify(this.tableData)\n        },\n        immediate:false,\n        deep:true\n      },\n      isShow(val, oldVal) {\n        if (!val){\n          this.$nextTick(() => {\n            this.end(true);\n          })\n        }\n      }\n    },\n    data(){\n      return {\n        form:{\n          goodsTitle:null,\n          goodsSn:null,\n          sendVoucher:null,\n          destroyJson:null,\n          receivedVoucher:null\n        },\n        tableData: [],\n        table:{\n          menu:true,\n          editBtn:false,\n          delBtn:false,\n          dialogType:'drawer',\n          dialogWidth:300,\n          column:[\n            {\n              label:'部位',\n              prop:'where',\n              span: 24,\n              rules: [{\n                required: true,\n                message: \"请输入收货说明\",\n                trigger: \"blur\"\n              }]\n            }, {\n              label:'详细描述',\n              prop:'info',\n              type:'textarea',\n              span: 24,\n              rules: [{\n                required: true,\n                message: \"请输入收货说明\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        },\n        param:null,\n        isShow:false,\n        imagesList:[],\n        showViewer:false,\n        srcList:[],\n        expressList:[],\n        domain:vue.$store.state.common.cloudDomain,\n        loading:false,\n        dialogVisible:false,\n        option:{\n          submitBtn:false,\n          emptyBtn:false,\n          labelWidth: 120,\n          column: [\n            {\n              label:'商品名称型号',\n              prop:'goodsTitle',\n              span: 24,\n              type:'title',\n            },{\n              label:'SN/IME码',\n              prop:'goodsSn',\n              span: 24,\n              type:'title',\n            },{\n              label:'寄回凭证',\n              prop:'sendVoucher',\n              span: 24,\n              type:'title',\n            },{\n              label:'收货SN',\n              prop:'receiveSn',\n              span: 12,\n              type:'input',\n              rules: [{\n                required: true,\n                message: \"请输入收货SN\",\n                trigger: \"blur\"\n              }]\n            },{\n              label:'收货IME',\n              prop:'receiveIme',\n              span: 12,\n              type:'input',\n              rules: [{\n                required: true,\n                message: \"请输入收货IME\",\n                trigger: \"blur\"\n              }]\n            },{\n              label:'收货凭证',\n              prop:'receivedVoucher',\n              type: 'upload',\n              span: 24,\n              listType: 'picture-card',\n              tip: '只能上传jpg/png文件，且不超过500kb',\n              propsHttp: {\n                home: vue.$store.state.common.cloudDomain,\n                res: \"data\",\n                url: 'name',\n                name: 'originalName'\n              },\n              action: '/api/blade-resource/oss/endpoint/put-file',\n              rules: [{\n                required: true,\n                message: \"请上传收货凭证\",\n                trigger: \"blur\"\n              }]\n            },{\n              label:'收货说明',\n              span: 24,\n              type:'textarea',\n              minRows:3,\n              maxRows:5,\n              prop:'note',\n              rules: [{\n                required: true,\n                message: \"请输入收货说明\",\n                trigger: \"blur\"\n              }]\n            },{\n              label:'损坏情况',\n              prop:'destroyJson',\n              span: 24,\n              type:'title',\n              rules: [{\n                required: true,\n                message: \"请完善损坏情况\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        }\n      }\n    },\n    created () {\n    },\n    computed: {\n      headers(){\n        return headers()\n      },\n    },\n    activated () { },\n    mounted() {\n      if (this.param.returnSendVoucher){\n        var list = this.param.returnSendVoucher.split(\",\")\n        for (const item of list) {\n          this.imagesList.push(this.domain+item)\n        }\n      }\n    },\n    methods:{\n      handleRowClick (row, event, column) {\n        this.$refs.crud.rowEdit(row,row.$index);\n      },\n      handleRowSave(row,done,loading){\n        console.log(row)\n        row.file = null;\n        row.image = null;\n        this.tableData.push(row)\n        done()\n      },\n      handleRowUpdate(row,index,done,loading){\n        this.tableData[index].file = row.file\n        this.tableData[index].image = row.image\n        this.tableData[index].where = row.where\n        this.tableData[index].info = row.info\n        done()\n      },\n      viewImage(){\n        this.showViewer = true;\n      },\n      handleAvatarSuccess(res, file,scope) {\n        console.log(res,scope)\n        this.tableData[scope.$index].file = res.data.name\n        this.tableData[scope.$index].image = res.data.link\n        this.srcList = [];\n        this.srcList.push(res.data.link)\n        // this.$forceUpdate()\n      },\n      getCombinationTitle(val){\n        return combinationTitle(val);\n      },\n      closeFn () {\n        this.isShow = false\n        this.$nextTick(() => {\n          this.end(false);\n        })\n      },\n      cancle () {\n        this.isShow = false\n        this.$nextTick(() => {\n          this.end(false);\n        })\n      },\n      submit(type){\n        this.$refs.form.validate((valid, done,msg) => {\n          if (valid) {\n            var params = {...this.form}\n            params.orderId = this.param.id;\n            params.id = this.param.receiveId;\n            params.status = type;\n            params.goodsSn = params.receiveSn\n            params.goodsIme = params.receiveIme\n            params.receivedVoucher = params.receivedVoucher.join(\",\");\n            console.log(params)\n            update(params).then(res => {\n              vue.$message({\n                type: 'success',\n                message: '操作成功!'\n              });\n              this.isShow = false;\n            }).catch(res => {\n            });\n          } else {\n            return false;\n          }\n        })\n      },\n    }\n  }\n</script>\n\n<style scoped>\n  ::v-deep .el-upload--picture-card {\n    width: 100px !important;\n    height: 100px !important;\n    line-height: 100px !important;\n  }\n  ::v-deep .el-upload-list--picture-card .el-upload-list__item{\n    width: 100px !important;\n    height: 100px !important;\n  }\n  ::v-deep .el-image-viewer__wrapper {\n    z-index: 9999 !important;\n  }\n\n  .imageview{\n    z-index: 9999 !important;\n  }\n\n  ::v-deep .el-empty {\n    padding: 0 0 !important;\n  }\n</style>\n"]}]}