{"remainingRequest":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workCode\\xiaoE\\大圣系统源码\\admin\\src\\views\\order\\order_info.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\src\\views\\order\\order_info.vue","mtime":1677748890000},{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678778409044},{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1678778390429},{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678778409044},{"path":"D:\\workCode\\xiaoE\\大圣系统源码\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1678778410194}],"contextDependencies":[],"result":["\n  import {getDetail} from \"@/api/order/order\";\n  import {getList} from \"@/api/order/operatingrecord\";\n  import {getList as getRecordList} from \"@/api/finance/smsrecord\";\n  import {getList as getNoteList} from \"@/api/order/ordernote\";\n  import {\n    combinationTitle,\n    packageName,\n    indexNumber,\n    buyoutPrice,\n    leaseTypeTitle,\n    calcBuyoutMoney\n  } from \"../../util/order\";\n  import Clipboard from 'clipboard';\n\n  import {deduction,order_express,} from \"../../components/order/order_dialog\";\n  import html2canvas from \"html2canvas\";\n  import JsPDF from 'jspdf'\n  import {getAge, getGenderByIdNumber} from \"../../util/util\";\n  import order_button from \"../../components/order/order_button\";\n  import OrderBillRecord from \"./orderbillrecord\";\n\n  import ClientRisk from \"../order/clientrisk\";\n  import ClientCredit from \"../order/clientcredit\";\n  import {audit, download} from \"../../api/order/order\";\n  import {checkBuyoutStatus, checkReturnStatus} from \"../../util/order\";\n  import ElImageViewer from \"element-ui/packages/image/src/image-viewer\";\n  import vue from \"../../main\";\n  import {toFixed} from \"../../constant/goods/constant\";\n  export default {\n    name: \"\",\n    components: {\n      order_button,\n      OrderBillRecord,\n      ClientRisk,\n      ClientCredit,\n      ElImageViewer\n    },\n    data() {\n      return {\n        orderBillRecordPain: {title: \"\", visible: false},\n        orderId:null,\n        bill: {},\n        table_key:1111,\n        loading:true,\n        activeName:0,\n        entryForm:[],\n        tabs:[\"基本信息\",\"操作记录\",\"存证记录\",\"备注信息\",\"信息发送记录\"],\n        evidences:[],\n        orderBills:[],\n        orderNotes:[],\n        smsList:[],\n        order:{},\n        imageslist:[],\n        clientAuth:{},\n        showViewer2:false,\n        orderInfo:{},\n        clientLink:{},\n        clientRisk:{},\n        clientCredit:{},\n        contracts:{},\n        client:{},\n        receiveGoods:{},\n        userOperatingRecord:[],\n        serveOperatingRecord:[],\n        clientRiskPain: {title: \"\", visible: false},\n        clientCreditPain: {title: \"\", visible: false},\n        option: {\n          searchShow: false,\n          searchMenuSpan: 6,\n          tip: false,\n          border: true,\n          editBtn:false,\n          addBtn:false,\n          delBtn:false,\n          index: false,\n          viewBtn: false,\n          selection: false,\n          searchBtn: false,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          menu: true,\n          menuWidth:240,\n          headerAlign: 'center',\n          align: 'center',\n          column: [\n            {\n              label: \"账单类型\",\n              prop: \"typeName\",\n              search:true,\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入订单编号\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"账单金额\",\n              prop: \"money\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"实付金额\",\n              prop: \"factPayMoney\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"减免金额\",\n              prop: \"reductionMoney\",\n              slot: true,\n\n            },\n            {\n              label: \"优惠金额\",\n              prop: \"couponMoney\",\n              slot: true,\n\n            },\n            {\n              label: \"滞纳金\",\n              slot: true,\n              prop: \"allOverdueMoney\",\n            },\n            {\n              label: \"应付款日期\",\n              width: 110,\n              prop: \"startTime\",\n            },\n            {\n              label: \"付款状态\",\n              prop: \"status\",\n              type: \"select\",\n              dicUrl: \"/api/blade-system/dict/dictionary?code=money_status\",\n              props: {\n                label: \"dictValue\",\n                value: \"dictKey\"\n              },\n            },\n            {\n              label: \"付款笔数\",\n              prop: \"payCount\",\n              rules: [{\n                required: true,\n                message: \"请输入每一期租金\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"创建时间\",\n              width: 140,\n              prop: \"createTime\",\n              rules: [{\n                required: true,\n                message: \"请输入免押方式\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        },\n        option2: {\n          searchShow: false,\n          searchMenuSpan: 6,\n          tip: false,\n          border: true,\n          editBtn:false,\n          addBtn:false,\n          delBtn:false,\n          index: true,\n          viewBtn: false,\n          selection: false,\n          searchBtn: false,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          menu: false,\n          headerAlign: 'center',\n          align: 'center',\n          column: [\n            {\n              label: \"操作说明\",\n              prop: \"title\",\n              slot: true\n            },\n            {\n              label: \"操作时间\",\n              prop: \"createTime\",\n              slot: true\n            }\n          ]\n        },\n        option3: {\n          searchShow: false,\n          searchMenuSpan: 6,\n          tip: false,\n          border: true,\n          editBtn:false,\n          addBtn:false,\n          delBtn:false,\n          index: true,\n          viewBtn: false,\n          selection: false,\n          searchBtn: false,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          menu: false,\n          headerAlign: 'center',\n          align: 'center',\n          column: [\n            {\n              label: \"操作说明\",\n              prop: \"title\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"操作人\",\n              prop: \"title\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"操作时间\",\n              prop: \"createTime\",\n              rules: [{\n                required: true,\n                message: \"请输入租期结束日\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        },option4: {\n          searchShow: false,\n          searchMenuSpan: 6,\n          tip: false,\n          border: true,\n          editBtn:false,\n          addBtn:false,\n          delBtn:false,\n          index: false,\n          viewBtn: false,\n          selection: false,\n          searchBtn: false,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          menu: false,\n          headerAlign: 'center',\n          align: 'center',\n          column: [\n            {\n              label: \"存证类型\",\n              prop: \"typeName\",\n              search:true,\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入订单编号\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"附件\",\n              prop: \"money\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"创建时间\",\n              prop: \"factPayMoney\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        },\n        option5: {\n          searchShow: false,\n          searchMenuSpan: 6,\n          tip: false,\n          border: true,\n          editBtn:false,\n          addBtn:false,\n          delBtn:false,\n          index: false,\n          viewBtn: false,\n          selection: false,\n          searchBtn: false,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          menu: false,\n          headerAlign: 'center',\n          align: 'center',\n          column: [\n            {\n              label: \"阶段\",\n              width:100,\n              prop: \"orderStatus\",\n              type: \"select\",\n              search: true,\n              dicUrl: \"/api/blade-system/dict/dictionary?code=order_status\",\n              props: {\n                label: \"dictValue\",\n                value: \"dictKey\"\n              },\n              rules: [{\n                required: true,\n                message: \"请输入订单编号\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"备注信息\",\n              prop: \"note\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"备注人\",\n              prop: \"userName\",\n              width:100,\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"备注时间\",\n              prop: \"createTime\",\n              width:150,\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入租期起始日\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        },\n        page: {\n          sms:{pageSize: 10,\n            currentPage: 1,\n            total: 0},\n          note:{pageSize: 10,\n            currentPage: 1,\n            total: 0},\n        },\n        option6: {\n          searchShow: false,\n          searchMenuSpan: 6,\n          tip: false,\n          border: true,\n          editBtn:false,\n          addBtn:false,\n          delBtn:false,\n          index: false,\n          viewBtn: false,\n          selection: false,\n          searchBtn: false,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          menu: false,\n          headerAlign: 'center',\n          align: 'center',\n          column: [\n            {\n              label: \"阶段\",\n              prop: \"orderStatus\",\n              type: \"select\",\n              width:100,\n              search: true,\n              dicUrl: \"/api/blade-system/dict/dictionary?code=order_status\",\n              props: {\n                label: \"dictValue\",\n                value: \"dictKey\"\n              },\n            },\n            {\n              label: \"发送内容\",\n              prop: \"params\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"发送人\",\n              prop: \"userName\",\n              width:\"100\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"发送结果\",\n              prop: \"statusCode\",\n              width:\"100\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入租期起始日\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"发送时间\",\n              prop: \"createTime\",\n              width:\"160\",\n              rules: [{\n                required: true,\n                message: \"请输入租期结束日\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        }\n      };\n    },\n    beforeDestroyed() {\n    },\n    mounted() {\n\n    },\n    created() {\n      // this.loading = true;\n      this.orderId=this.$route.query.orderId;\n      this.getDetail()\n      this.getRecord();\n    },\n    watch: {\n      activeName: function (){\n        console.log(\"option变化了\")\n        this.table_key = new Date().getTime();\n      },\n    },\n    methods: {\n      viewImage(){\n        this.imageslist = [];\n        if (this.clientAuth.idCardFrontUrl){\n          this.imageslist.push(this.clientAuth.idCardFrontUrl)\n          this.imageslist.push(this.clientAuth.idCardBackUrl)\n        }\n        if (this.clientAuth.faceUrl){\n          this.imageslist.push(this.$store.state.common.cloudDomain+this.clientAuth.faceUrl)\n        }\n        console.log(this.imageslist)\n      },\n      buyoutStatus(){\n        return \"买断\"+checkBuyoutStatus(this.order)\n      },\n      returnStatus(){\n        return \"归还\"+checkReturnStatus(this.order)\n      },\n      getSex(cardNo){\n        return getGenderByIdNumber(cardNo)\n      },\n      getAge(cardNo){\n        return getAge(cardNo);\n      },\n      getRecord(){\n        var param = {orderId:this.orderId};\n        getList(1,1000,param).then(res => {\n          this.userOperatingRecord = []\n          this.serveOperatingRecord = []\n          console.log(res.data.data.records)\n          for (const item of res.data.data.records) {\n            if (item.clientId&&item.clientId != -1){\n              this.userOperatingRecord.push(item)\n            }else{\n              this.serveOperatingRecord.push(item)\n            }\n          }\n          // this.loading = false;\n          this.$nextTick(() => {\n            this.loading = false;\n          })\n        }).catch(res => {\n          this.$nextTick(() => {\n            this.loading = false;\n          })\n        })\n      },\n      getDetail(){\n        // var loadinstance = Loading.service({fullscreen:true})\n        this.loading = true;\n        getDetail(this.orderId).then(res => {\n          this.order = res.data.data.order;\n          this.orderInfo = res.data.data.orderInfo;\n          this.clientAuth = res.data.data.clientAuth;\n          this.orderBills = res.data.data.bills;\n          this.clientLink = res.data.data.detail;\n          this.client = res.data.data.client;\n          this.receiveGoods = res.data.data.receiveGoods;\n          this.clientRisk = res.data.data.clientRisk;\n          this.clientCredit = res.data.data.clientCredit;\n          this.contracts = res.data.data.contracts;\n\n          this.orderBills.sort(function(a, b){\n            var orderNumber1 = a.orderNumber?a.orderNumber:0;\n            var orderNumber2 = b.orderNumber?b.orderNumber:0;\n            if (orderNumber1>orderNumber2){\n              return 1;\n            }else if (orderNumber1<orderNumber2){\n              return -1;\n            }else {\n              return 0;\n            }\n            return 0;\n          });\n\n          this.order.payRentMoney = 0;\n          this.order.noPayRentMoney = 0;\n          this.order.hasPayMoney = 0;\n          this.order.noPayMoney = 0;\n          for (var  bill of this.orderBills) {\n            if (bill.type == \"2\"){\n              continue;\n            }\n            if (bill.type == '10'){\n              continue;\n            }\n            var pay = Number.parseFloat(bill.factPayMoney)+Number.parseFloat(bill.reductionMoney)\n              +Number.parseFloat(bill.couponMoney)+Number.parseFloat(bill.depositMoney);\n            if (bill.type ==5){\n              this.order.payRentMoney = this.order.payRentMoney + pay;\n              this.order.noPayRentMoney = this.order.noPayRentMoney + Number.parseFloat(bill.money) -pay;\n            }\n            this.order.hasPayMoney = this.order.hasPayMoney + pay;\n            var start = new Date(bill.paymentTime);\n            var now = new Date().getTime();\n            if (start.getTime()<=now){\n              this.order.noPayMoney = this.order.noPayMoney + Number.parseFloat(bill.money) - pay;\n            }\n          }\n          this.order.payRentMoney = toFixed(this.order.payRentMoney,2)\n          this.order.noPayRentMoney = toFixed(this.order.noPayRentMoney,2)\n          this.order.hasPayMoney = toFixed(this.order.hasPayMoney,2)\n          this.order.noPayMoney = toFixed(this.order.noPayMoney,2)\n\n          this.order.hasFreeze = 1;\n\n          if (this.receiveGoods){\n            this.order.sendVoucher = this.receiveGoods.sendVoucher\n            this.order.sendNote = this.receiveGoods.sendNote\n            this.order.depositType = this.receiveGoods.depositType\n            this.order.destroyJson = this.receiveGoods.destroyJson\n          }\n          this.order.bills = this.orderBills;\n          if (this.order.entryForm)\n            this.entryForm = JSON.parse(this.order.entryForm)\n          this.$nextTick(() => {\n            this.loading = false;\n          })\n          this.viewImage()\n        }).catch(res => {\n          this.$nextTick(() => {\n            this.loading = false;\n          })\n        })\n      },\n      copy(bt){\n        let clipboard = new Clipboard(bt);\n        clipboard.on('success', e => {\n          this.$message({\n            type: \"success\",\n            message: \"复制成功!\"\n          });\n          clipboard.destroy()\n        })\n        clipboard.on('error', e => {\n          // 不支持复制\n          this.$message({\n            type: \"success\",\n            message: \"该浏览器不支持自动复制!\"\n          });\n          clipboard.destroy()\n        })\n      },\n      onLoad(page, params = {}) {\n        var param = {orderId:this.orderId};\n        getRecordList(page.currentPage, page.pageSize,param).then(res => {\n          const data = res.data.data;\n          this.page.total = data.total;\n          this.smsList = data.records;\n        }).catch(res => {\n\n        })\n      },\n      onNotesLoad(page, params = {}) {\n        var param = {orderId:this.orderId};\n        getNoteList(1, 1000,param).then(res => {\n          const data = res.data.data;\n          this.page.total = data.total;\n          this.orderNotes = data.records;\n        }).catch(res => {\n\n        })\n      },\n      start() {\n\n      },\n      end(key){\n        console.log(\"--2---\",key)\n        this.table_key = new Date().getTime();\n        if (key == \"entryForm\" || key == \"changeBt\" || key == \"deductMoney\" || key ==  \"buyout_check\" || key == 'return_check' || key == \"order_buyout\"){\n          this.getDetail()\n          this.getRecord();\n        }\n        if (key == \"edit\"){\n          this.getDetail()\n          this.getRecord();\n        }\n        if (key == \"cancle\"){\n          this.getDetail()\n          this.getRecord();\n        }\n        if (key == \"pass\"){\n          this.getDetail()\n          this.getRecord();\n        }\n      },\n      goback(){\n        this.$EventBus.$emit('tag', {\n          action:\"remove\",\n          value:\"/order/view/index\",\n          isOpenTag:true,\n          isMatchAll:false\n        })\n      },\n      goodsInfo(){\n        this.$router.push({\n          path: \"/goods/view/index\",\n          query: {\n            goodsId : this.order.goodsId,\n          },\n        });\n      },\n      refer(){\n        this.getDetail();\n        this.getRecord();\n      },\n      express(orderId){\n        order_express({data:this.order.id,key:\"orderExpress\",fn:null})\n      },\n      currentChange(currentPage){\n        this.page.currentPage = currentPage;\n      },\n      sizeChange(pageSize){\n        this.page.pageSize = pageSize;\n      },\n      getLeaseTypeTitle(val){\n        var ss = leaseTypeTitle(val)\n        return ss;\n      },\n      getCombinationTitle(val){\n        return combinationTitle(val);\n      },\n      getPackageName(val){\n        return packageName(val);\n      },\n      getNperNumber(){\n        return indexNumber(this.order,this.orderBills);\n      },\n      getBuyoutPrice(val){\n        return buyoutPrice(val,this.order.totalPricesRate)\n      },\n      getPremiumMoney(val){\n        if (!val)\n          return\n        return JSON.parse(val).premiumMoney\n      },\n      getNowBuyoutMoney(){\n        return toFixed(calcBuyoutMoney(this.order,this.orderBills),2)\n      },\n      getOrderNperNumber(val){\n        console.log()\n        if (val.row.type == 5){\n          return \"第\"+val.row.orderNumber+\"期租金\"\n        }else{\n          return val.label;\n        }\n      },\n      contractDownload(key){\n        var name = this.contracts[key].contractName;\n        download(this.contracts[key].contractNo).then(res => {\n          var pdf = res.data.data.data;\n          const linkSource = `data:application/pdf;base64,${pdf}`;\n          const downloadLink = document.createElement(\"a\");\n          downloadLink.href = linkSource;\n          downloadLink.download = name+\".pdf\";\n          downloadLink.click();\n        }).catch(res => {\n        });\n      },\n      pdfDownload() {\n        console.log(\"----------\")\n        let images = [];\n        let _this = this\n        let enterForm = this.$refs.enterForm; //获取ref里面的内容\n        let basicInfo = this.$refs.basicInfo;\n        let height = 0;\n        let PDF = new JsPDF('', 'pt', 'a4')\n        html2canvas(basicInfo, {\n          useCORS: true, //是否尝试使用CORS从服务器加载图像\n          allowTaint: true,\n          dpi: 300, //解决生产图片模糊\n          scale: 3, //清晰度--放大倍数\n        }).then(function (canvas) {\n          let contentWidth = canvas.width\n          let contentHeight = canvas.height\n          let pageHeight = contentWidth / 592.28 * 841.89 // 一页pdf显示html页面生成的canvas高度;\n          let leftHeight = contentHeight //未生成pdf的html页面高度\n          let position = 0 //pdf页面偏移\n          //a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高\n          // let imgWidth = 595.28\n          let imgWidth = 560.28  //宽度\n          let imgHeight = 592.28 / contentWidth * contentHeight\n          let pageData = canvas.toDataURL('image/jpeg', 1.0)\n          // 有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)\n          //当内容未超过pdf一页显示的范围，无需分页\n          PDF.addImage(pageData, 'JPEG', 20, 20, imgWidth, imgHeight)\n          height = height+imgHeight\n          console.log(\"----------\",enterForm)\n          html2canvas(enterForm, {\n            useCORS: true, //是否尝试使用CORS从服务器加载图像\n            allowTaint: true,\n            dpi: 300, //解决生产图片模糊\n            scale: 3, //清晰度--放大倍数\n          }).then(function (canvas) {\n            let contentWidth = canvas.width\n            let contentHeight = canvas.height\n            let pageHeight = contentWidth / 592.28 * 841.89 // 一页pdf显示html页面生成的canvas高度;\n            let leftHeight = contentHeight //未生成pdf的html页面高度\n            let position = 0 //pdf页面偏移\n            //a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高\n            // let imgWidth = 595.28\n            let imgWidth = 560.28  //宽度\n            let imgHeight = 592.28 / contentWidth * contentHeight\n            let pageData = canvas.toDataURL('image/jpeg', 1.0)\n            // 有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)\n            //当内容未超过pdf一页显示的范围，无需分页\n            let start = height;\n            height = height+imgHeight;\n            if (leftHeight < pageHeight) {\n              PDF.addImage(pageData, 'JPEG', 20, start+50, imgWidth, imgHeight)\n            } else {\n                // while (leftHeight > 0) {\n                //   PDF.addImage(pageData, 'JPEG', 20, height, imgWidth, imgHeight)\n                //   leftHeight -= pageHeight\n                //   position -= 841.89\n                //   if (leftHeight > 0) {\n                //     PDF.addPage()\n                //   }\n                // }\n            }\n            let title = _this.order.clientName+\" \"+_this.order.no+\"进件单\"\n            PDF.save(_this.$t(title) + '.pdf')//下载标题\n          })\n        });\n      },\n      beforeCloseDialog(done) {\n        done();\n      },\n      showDialogPage(row, type) {\n        if (type == 'orderBillRecord') {\n          this.bill = row;\n          this.orderBillRecordPain.visible = true;\n          this.orderBillRecordPain.title = row.typeName + \" - 支付记录\";\n        }\n        if (type == 'clientRisk') {\n          this.clientRiskPain.visible = true;\n          this.clientRiskPain.title = this.clientAuth.name + \" - 风控报告\";\n        }\n        if (type == 'clientCredit') {\n          this.clientCreditPain.visible = true;\n          this.clientCreditPain.title = this.clientAuth.name + \" - 征信报告\";\n        }\n      },\n      deductMoney(row,type) {\n        var fn = {start:this.start,end:this.end}\n        var order = {...row}\n        order.openType = type\n        order.hasBill = true\n        deduction({data:order,key:\"deductMoney\",fn:fn});\n      },\n    }\n  }\n",{"version":3,"sources":["order_info.vue"],"names":[],"mappings":";AAgnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"order_info.vue","sourceRoot":"src/views/order","sourcesContent":["<template>\n  <div style=\"height: 100%;\">\n    <el-form ref=\"form1\" label-width=\"120px\" size=\"small\" style=\"flex-direction: column;height: 100%;display: flex;\">\n      <div class=\"top-bar-title top\">\n        <div style=\"line-height: 40px;display: flex;justify-content: space-between;width: 100%\">\n          <div>\n            <span style=\"font-weight: bold\">单号：</span>\n            <span style=\"color: #169BD5\">{{order.no}} </span>\n            <i class=\"el-icon-document-copy btn\"\n               data-clipboard-action=\"copy\"\n               :data-clipboard-text=\"order.no\" @click=\"copy('.btn')\"\n               style=\"cursor: pointer;\"></i>\n            <el-tag  effect=\"dark\" size=\"small\" class=\"btn2\" style=\"margin-left: 10px;cursor: pointer;\"\n                     data-clipboard-action=\"copy\"\n                     v-if=\"order.parentNo\"\n                     :data-clipboard-text=\"order.no\" @click=\"copy('.btn2')\">续租订单 <i class=\"el-icon-document-copy\" ></i></el-tag>\n            <el-tag  type=\"danger\" effect=\"dark\" size=\"small\" style=\"margin-left: 10px\">{{ order.statusName }}\n            </el-tag>\n            <el-tag v-if=\"order.status == 8 && order.statusBuyout&&order.openBuyout == 1\" type=\"danger\" effect=\"dark\" size=\"small\" style=\"margin-left: 10px\">\n                {{buyoutStatus()}}\n            </el-tag>\n            <el-tag v-if=\"order.status == 8 && order.statusReturn&&order.openReturn == 1\" type=\"danger\" effect=\"dark\" size=\"small\" style=\"margin-left: 10px\">\n                {{returnStatus()}}\n            </el-tag>\n          </div>\n          <div style=\"flex: 1;text-align: end;\">\n            <el-button plain icon=\"el-icon-arrow-left\" @click=\"goback()\" size=\"mini\">返回</el-button>\n            <el-button type=\"primary\" icon=\"el-icon-refresh\" @click=\"refer()\" size=\"mini\">刷新</el-button>\n            <order_button v-bind:order=\"order\" @start=\"start\" @end=\"end\" v-bind:type=\"'orderInfo'\"></order_button>\n          </div>\n        </div>\n        <div class=\"top_contain\" v-if=\"false\">\n          <div class=\"top_item\">\n            <span>\n              申请人：\n            </span>\n            <span>\n               {{clientAuth.name}}\n            </span>\n          </div>\n          <div class=\"top_item\">\n            <span>\n              下单时间：\n            </span>\n            <span>\n               {{order.createTime}}\n            </span>\n          </div>\n          <div class=\"top_item\">\n            <span>\n              租用周期：\n            </span>\n            <span>\n                {{order.startRentTime}}~{{order.endRentTime}}\n            </span>\n          </div>\n          <div class=\"top_item\">\n            <span>\n              租用商品：\n            </span>\n            <span>\n              {{order.goodsTitle}}\n            </span>\n          </div>\n        </div>\n        <el-tabs v-model=\"activeName\" >\n          <el-tab-pane :label=\"item\" v-for=\"(item,index) of tabs\">\n          </el-tab-pane>\n        </el-tabs>\n      </div>\n      <div style=\"min-height: 0;flex: 1;\">\n        <div v-loading=\"loading\" style=\"height:100%;width:100%;z-index: 9999;position: absolute\" v-if=\"loading\"></div>\n        <div style=\"height:100%;overflow-y: scroll;\" class=\"myscollbar\">\n          <div style=\"width: 100%\"  v-if=\"activeName == 0\">\n            <el-card class=\"info\">\n              <div slot=\"header\" class=\"clearfix\" style=\"display: flex;justify-content: space-between;\">\n                <span style=\"font-weight: bold\">用户认证信息(芝麻认证)</span>\n                <div style=\"font-weight: bold\">\n                  <span v-if=\"clientAuth.idAuth == 1\" style=\"color: #00a680\">已认证</span>\n                  <span v-if=\"clientAuth.idAuth != 1\" style=\"color: red\">未认证</span>\n                </div>\n              </div>\n              <div class=\"user_info\"  ref=\"basicInfo\">\n                <el-descriptions class=\"margin-top\" :column=\"3\" :size=\"size\" border>\n                  <template slot=\"extra\" v-if=\"false\">\n                    <el-button type=\"primary\" size=\"small\">操作</el-button>\n                  </template>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-user\"></i>\n                      申请人\n                    </template>\n                    {{clientAuth.name}}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-female\" v-if=\"getSex(clientAuth.idCard) == '女'\"></i>\n                      <i class=\"el-icon-male\" v-if=\"getSex(clientAuth.idCard) == '男'\"></i>\n                      性别\n                    </template>\n                    {{ getSex(clientAuth.idCard) }}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-thumb\" ></i>\n                      年龄\n                    </template>\n                    {{ getAge(clientAuth.idCard) }}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-postcard\" ></i>\n                      邮箱\n                    </template>\n                    {{client.email}}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-mobile-phone\"></i>\n                      认证手机号码\n                    </template>\n                    {{order.clientPhone}}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-bank-card\"></i>\n                      身份证号码\n                    </template>\n                    {{clientAuth.idCard}}\n                  </el-descriptions-item>\n                  <el-descriptions-item :span=\"3\">\n                    <template slot=\"label\">\n                      <i class=\"el-icon-takeaway-box\"></i>\n                      历史记录\n                    </template>\n                    申请1次,拒绝0次\n                  </el-descriptions-item>\n                  <el-descriptions-item :span=\"3\">\n                    <template slot=\"label\">\n                      <i class=\"el-icon-location-outline\"></i>\n                      定位地址\n                    </template>\n                    {{ orderInfo.country+orderInfo.province+orderInfo.city+orderInfo.district }}\n                  </el-descriptions-item>\n\n                  <el-descriptions-item :span=\"3\">\n                    <template slot=\"label\">\n                      <i class=\"el-icon-map-location\"></i>\n                      认证地址\n                    </template>\n                    {{ clientAuth.idCardAddress }}\n                  </el-descriptions-item>\n\n                  <el-descriptions-item :span=\"3\">\n                    <template slot=\"label\">\n                      <i class=\"el-icon-office-building\"></i>\n                      收货地址\n                    </template>\n                    {{ orderInfo.sendUserAddress }}\n                  </el-descriptions-item>\n                  <el-descriptions-item :span=\"3\">\n                    <template slot=\"label\">\n                      <i class=\"el-icon-picture\"></i>\n                      身份证/人脸照片\n                    </template>\n                    <div>\n                      <img style=\"height: 100px;margin-right: 10px\" @click=\"showViewer2 = true\" :src=\"item\" v-for=\"item of imageslist\">\n                    </div>\n<!--                    <i  class=\"el-icon-view hand\" style=\"color: #169BD5\" @click=\"viewImage\">查看照片</i>-->\n                  </el-descriptions-item>\n                </el-descriptions>\n                <el-descriptions style=\"margin-top: 20px\" title=\"紧急联系人\" :column=\"3\" :size=\"size\" border>\n                  <template slot=\"extra\">\n                    <el-button type=\"primary\" size=\"small\">编辑</el-button>\n                  </template>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-user\"></i>\n                      姓名\n                    </template>\n                    {{ clientLink?clientLink.oneLinkName:\"暂无\" }}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-paperclip\"></i>\n                      关系\n                    </template>\n                    {{ clientLink?clientLink.oneLinkRelation:\"暂无\" }}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-mobile-phone\"></i>\n                      手机号\n                    </template>\n                    {{ clientLink?clientLink.oneLinkPhone:\"暂无\" }}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-user\"></i>\n                      姓名\n                    </template>\n                    {{ clientLink?clientLink.twoLinkName:\"暂无\" }}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-paperclip\"></i>\n                      关系\n                    </template>\n                    {{ clientLink?clientLink.twoLinkRelation:\"暂无\" }}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-mobile-phone\"></i>\n                      手机号\n                    </template>\n                    {{ clientLink?clientLink.twoLinkPhone:\"暂无\" }}\n                  </el-descriptions-item>\n                </el-descriptions>\n              </div>\n            </el-card>\n\n            <el-card class=\"info\">\n              <div slot=\"header\" class=\"clearfix\" style=\"display: flex;justify-content: space-between;\">\n                <span style=\"font-weight: bold\">风控征信</span>\n                <div style=\"font-weight: bold\">\n                  <span v-if=\"clientAuth.idAuth == 1\" style=\"color: #00a680\"></span>\n                  <span v-if=\"clientAuth.idAuth != 1\" style=\"color: red\"></span>\n                </div>\n              </div>\n              <div class=\"user_info\">\n                <el-descriptions class=\"margin-top\" title=\"风控信息\" :column=\"3\" :size=\"size\" border>\n                  <template slot=\"extra\">\n                    <el-button type=\"primary\" size=\"small\" @click=\"showDialogPage(null,'clientRisk')\">查看风控详情</el-button>\n<!--                    <el-button type=\"danger\" size=\"small\">拉取最新风控</el-button>-->\n                  </template>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-warning-outline\"></i>\n                      审核建议\n                    </template>\n                    {{ clientRisk?clientRisk.verifyRecomment:\"\"}}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-s-order\"></i>\n                      风控分数\n                    </template>\n                    {{ clientRisk?clientRisk.scoreNormExplain:\"\" }}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-view\"></i>\n                      押金建议\n                    </template>\n                    {{ clientRisk?clientRisk.suggestCash:\"\" }}\n                  </el-descriptions-item>\n                </el-descriptions>\n\n                <el-descriptions style=\"margin-top: 20px\" title=\"征信信息\" :column=\"3\" :size=\"size\" border>\n                  <template slot=\"extra\">\n<!--                    <el-button type=\"primary\" size=\"small\" @click=\"showDialogPage(null,'clientCredit')\">查看征信详情</el-button>-->\n<!--                    <el-button type=\"danger\" size=\"small\">拉取最新征信</el-button>-->\n                  </template>\n                  <el-descriptions-item  >\n                    <template slot=\"label\">\n                      <i class=\"el-icon-warning-outline\"></i>\n                      审核建议\n                    </template>\n                    <span class=\"item_w\">{{ clientCredit&&clientCredit.rules?clientCredit.rules.replaceAll(\"REJECT\",\"拒绝\"):\"暂无\"}}</span>\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-s-order\"></i>\n                      风控分数\n                    </template>\n                    {{ clientCredit?clientCredit.score:\"暂无\" }}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      <i class=\"el-icon-view\"></i>\n                      押金建议\n                    </template>\n                    {{ clientCredit?clientCredit.modelType:\"暂无\" }}\n                  </el-descriptions-item>\n                </el-descriptions>\n              </div>\n            </el-card>\n\n            <el-card class=\"info\">\n              <div class=\"user_info\">\n                <el-descriptions class=\"margin-top\" title=\"业务信息\" :column=\"3\" :size=\"size\" border>\n                  <template slot=\"extra\">\n                  </template>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      商品名称\n                    </template>\n                    {{order.goodsTitle}}(<span style=\"color: #169BD5\" class=\"hand\" @click=\"goodsInfo\">查看详情</span>）\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      商品分类\n                    </template>\n                    {{order.firstClass}}/{{order.secondClass}}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      商品规格\n                    </template>\n                    {{getCombinationTitle(order.goodsCombinationJson)}}\n                  </el-descriptions-item>\n\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      租期\n                    </template>\n                    {{order.lease}}个{{ getLeaseTypeTitle(order.leaseType) }}({{getPackageName(order.goodsCombinationJson)}})\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      每一期租金\n                    </template>\n                    {{ order.rentPerMoney }} (第{{order.rentFirstMoney}}期)(总租金{{ order.rentMoney }})\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      已付租金\n                    </template>\n                    {{order.payRentMoney}}(未付租金：{{order.noPayRentMoney}})\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      当前买断价\n                    </template>\n                    {{getNowBuyoutMoney()}}(总买断价：{{getBuyoutPrice(order.goodsCombinationJson)}})\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      押金\n                    </template>\n                    免押额度{{order.amount}}/免押金额{{order.depositMoneyFree}}(实付金额{{order.depositMoneyPay}})\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      免押方式\n                    </template>\n                    {{order.freeType == '1'?\"芝麻信用免押\":\"其他\"}}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      订单支付\n                    </template>\n                    {{order.hasPayMoney}}(待支付{{order.noPayMoney}})\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      当前期数\n                    </template>\n                    第{{getNperNumber(order.startRentTime,order.endRentTime,order.lease,order.leaseType)}}期\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      已使用优惠券\n                    </template>\n                    0(首期减免)\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      待退还押金\n                    </template>\n                    {{order.depositMoneyPay}}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      已退还押金\n                    </template>\n                    0.0\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      溢价金\n                    </template>\n                    {{getPremiumMoney(order.goodsCombinationJson)}}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      设备SN\n                    </template>\n                    {{orderInfo.goodsSn}}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      设备供货商\n                    </template>\n                    {{orderInfo.buyingChannel}}\n                  </el-descriptions-item>\n                  <el-descriptions-item>\n                    <template slot=\"label\">\n                      增值服务\n                    </template>\n                    <span type=\"primary\"  v-if=\"order.extraServiceList.length>0\" v-for=\"tag in order.extraServiceList\" style=\"margin-right: 10px;color: #169BD5\">{{tag.name+'('+tag.price+')'}}</span>\n                  </el-descriptions-item>\n                </el-descriptions>\n              </div>\n            </el-card>\n\n            <el-card class=\"info\">\n              <div slot=\"header\" class=\"clearfix\">\n                <span style=\"font-weight: bold\">账单信息</span>\n              </div>\n              <div class=\"user_info\">\n                <avue-crud :key=\"table_key\"  ref=\"crud\" :option=\"option\" :data=\"orderBills\">\n                  <template #menu=\"{row,index,size}\">\n                    <div style=\"display: flex\">\n                      <el-button type=\"text\" size=\"mini\" icon=\"el-icon-view\" v-if=\"(row.factPayMoney && Number.parseFloat(row.factPayMoney)>0 )\" @click=\"showDialogPage(row,'orderBillRecord')\" >查看记录</el-button>\n                      <el-button type=\"text\" size=\"mini\" icon=\"el-icon-edit\" v-if=\"['1','3'].includes(row.status+'') && (new Date(row.paymentTime)).getTime()<=(new Date()).getTime()\"  @click=\"deductMoney(row,'online')\">线上扣款</el-button>\n                      <el-button type=\"text\" size=\"mini\" icon=\"el-icon-delete\" v-if=\"['1','3'].includes(row.status+'') && (new Date(row.paymentTime)).getTime()<=(new Date()).getTime()\"  @click=\"deductMoney(row,'offline')\">线下扣款</el-button>\n                    </div>\n                  </template>\n                  <template slot=\"typeName\" slot-scope=\"scope\">\n                    <span>{{ getOrderNperNumber(scope) }}</span>\n                  </template>\n                  <template slot=\"allOverdueMoney\" slot-scope=\"scope\">\n                    <span v-if=\"scope.row.allOverdueMoney>0\">{{ scope.row.allOverdueMoney }}(未付<span style=\"color: #dd6161\">{{scope.row.noPayOverdueMoney}}</span>)</span>\n                    <span v-else>~</span>\n                  </template>\n                </avue-crud>\n              </div>\n            </el-card>\n\n            <el-card class=\"info\" v-if=\"entryForm&&entryForm.length>0\">\n              <div slot=\"header\" style=\"display: flex;justify-content: space-between\">\n                <span style=\"font-weight: bold\">进件单</span>\n                <el-button type=\"primary\" @click=\"pdfDownload\">下载<i class=\"el-icon-download el-icon--right\"></i></el-button>\n              </div>\n              <div class=\"user_info\" ref=\"enterForm\">\n                <div class=\"div_table\">\n                  <template v-for=\"entry in entryForm\">\n                    <el-descriptions direction=\"vertical\" style=\"margin-top: 20px\" :title=\"entry.title\" :column=\"entry.value.length>=4?4:3\" :size=\"size\" border>\n                      <template v-if=\"entry.value.length>0&&entry.value[0].constructor === Object\">\n                        <el-descriptions-item :span=\"1\" label-class-name=\"my-label\" content-class-name=\"my-content\"  v-for=\"item in entry.value\">\n                          <template slot=\"label\">\n                            {{ item.title}}\n                          </template>\n                          {{ item.value }}\n                        </el-descriptions-item>\n                      </template>\n                    </el-descriptions>\n\n                  </template>\n                </div>\n              </div>\n            </el-card>\n\n            <el-card class=\"info\">\n              <div slot=\"header\" class=\"clearfix\">\n                <span style=\"font-weight: bold\">协议下载</span>\n              </div>\n              <div class=\"user_info\">\n                <table>\n                  <tbody>\n                  <tr>\n                    <td style=\"text-align: center\">\n                      租赁合同   <span style=\"color: #1e9fff\" class=\"hand\" v-if=\"contracts&&contracts.contractRent\" @click=\"contractDownload('contractRent')\">下载</span>（<span style=\"color: #1e9fff\">查看{{ client.contractRentNum }}次</span>）\n                    </td>\n                    <td style=\"text-align: center\">\n                      用户授权合同 <span style=\"color: #1e9fff\" class=\"hand\" v-if=\"contracts&&contracts.contractAuthorization\" @click=\"contractDownload('contractAuthorization')\">下载</span>（<span style=\"color: #1e9fff\">查看{{ client.contractAuthorizationNum }}次</span>）\n                    </td>\n                    <td style=\"text-align: center\">\n                      个人信用信息查询及报送授权书 <span style=\"color: #1e9fff\" class=\"hand\" v-if=\"contracts&&contracts.contractPersonalCredit\" @click=\"contractDownload('contractPersonalCredit')\">下载</span>（<span style=\"color: #1e9fff\">查看{{ client.contractPersonalCreditNum }}次</span>）\n                    </td>\n                  </tr>\n                  <tr>\n                    <td style=\"text-align: center\">\n                    商品签收确认书 <span style=\"color: #1e9fff\" class=\"hand\" v-if=\"contracts&&contracts.contractGoodsReceived\" @click=\"contractDownload('contractGoodsReceived')\">下载</span>（<span style=\"color: #1e9fff\">查看{{ client.contractGoodsReceivedNum }}次</span>）\n                    </td>\n                    <td>\n                      &nbsp;\n                    </td>\n                    <td>\n                      &nbsp;\n                    </td>\n                  </tr>\n                  </tbody>\n                </table>\n              </div>\n            </el-card>\n\n            <el-card class=\"info\">\n              <div slot=\"header\" class=\"clearfix\">\n                <span style=\"font-weight: bold\">物流信息</span>\n              </div>\n              <div class=\"user_info\">\n                <div class=\"logistics\">物流公司：{{ orderInfo.sendExpressCompany?orderInfo.sendExpressCompany:\"暂无\"}}</div>\n                <div class=\"logistics\">物流单号：{{ orderInfo.sendExpressNo?orderInfo.sendExpressNo:\"暂无\"}} <i class=\"el-icon-document-copy\" v-if=\"orderInfo.sendExpressNo\"></i>\n                  <el-button plain size=\"small\" style=\"margin-left: 10px\" @click=\"express(orderInfo.orderId)\" v-if=\"orderInfo.sendExpressNo\">查看物流信息</el-button>\n                  <el-button plain size=\"small\" v-if=\"contracts&&contracts.contractGoodsReceived\" @click=\"contractDownload('contractGoodsReceived')\">查看签收回执单</el-button>\n                </div>\n                <div class=\"logistics\">收货地址：{{orderInfo.sendUserAddress}}</div>\n                <div class=\"logistics\">收货人姓名：{{orderInfo.sendUserName}}</div>\n                <div class=\"logistics\">收货人电话：{{orderInfo.sendUserPhone}}</div>\n              </div>\n            </el-card>\n\n            <el-card class=\"info\">\n              <div slot=\"header\" class=\"clearfix\">\n                <span style=\"font-weight: bold\">归还信息</span>\n              </div>\n              <div class=\"user_info\">\n                <div class=\"logistics\">物流公司：{{ orderInfo.receiveExpressCompany?orderInfo.receiveExpressCompany:\"暂无\"}}</div>\n                <div class=\"logistics\">物流单号：{{ orderInfo.receiveExpressNo?orderInfo.receiveExpressNo:\"暂无\"}} <i class=\"el-icon-document-copy\" v-if=\"orderInfo.receiveExpressNo\"></i>\n                  <el-button plain size=\"small\" style=\"margin-left: 10px\" v-if=\"orderInfo.receiveExpressNo\">查看物流信息</el-button>\n                </div>\n                <div class=\"logistics\">归还地址：{{ orderInfo.receiveUserAddress }}</div>\n                <div class=\"logistics\">收货人姓名：{{ orderInfo.receiveUserName }}</div>\n                <div class=\"logistics\">收货人电话：{{orderInfo.receiveUserPhone}}</div>\n              </div>\n            </el-card>\n          </div>\n          <div style=\"width: 100%\" v-if=\"activeName == 1\">\n            <el-card class=\"info\" >\n              <div slot=\"header\" class=\"clearfix\">\n                <span style=\"font-weight: bold\">用户操作记录</span>\n              </div>\n              <div class=\"user_info\">\n                <avue-crud ref=\"crud1\" :option=\"option2\" :data=\"userOperatingRecord\">\n                </avue-crud>\n              </div>\n            </el-card>\n            <el-card class=\"info\">\n              <div slot=\"header\" class=\"clearfix\">\n                <span style=\"font-weight: bold\">平台操作记录</span>\n              </div>\n              <div class=\"user_info\">\n                <avue-crud ref=\"crud\" :option=\"option3\" :data=\"serveOperatingRecord\">\n                </avue-crud>\n              </div>\n            </el-card>\n          </div>\n          <div style=\"width: 100%\" v-if=\"activeName == 2\">\n            <el-card class=\"info\" >\n              <div slot=\"header\" class=\"clearfix\">\n                <span style=\"font-weight: bold\">存证记录</span>\n              </div>\n              <div class=\"user_info\">\n                <avue-crud ref=\"crud2\" :option=\"option4\" :data=\"evidences\">\n                </avue-crud>\n              </div>\n            </el-card>\n<!--            <el-card class=\"info\">-->\n<!--              <div slot=\"header\" class=\"clearfix\">-->\n<!--                <span style=\"font-weight: bold\">合同下载</span>-->\n<!--              </div>-->\n<!--              <div class=\"user_info\">-->\n\n<!--              </div>-->\n<!--            </el-card>-->\n          </div>\n          <div style=\"width: 100%\" v-if=\"activeName == 3\">\n            <el-card class=\"info\" >\n              <div slot=\"header\" class=\"clearfix\">\n                <span style=\"font-weight: bold\">备注信息</span>\n              </div>\n              <div class=\"user_info\">\n                <avue-crud ref=\"crud3\" :key=\"table_key\" :option=\"option5\" :data=\"orderNotes\" :page=\"page.note\" @on-load=\"onNotesLoad\">\n                </avue-crud>\n              </div>\n            </el-card>\n          </div>\n          <div style=\"width: 100%\" v-if=\"activeName == 4\">\n            <el-card class=\"info\" >\n              <div slot=\"header\" class=\"clearfix\">\n                <span style=\"font-weight: bold\">信息发送记录</span>\n              </div>\n              <div class=\"user_info\">\n                <avue-crud ref=\"crud4\" :key=\"table_key\"  :option=\"option6\" :page=\"page.sms\"\n                           @current-change=\"currentChange\"\n                           @size-change=\"sizeChange\"\n                           @on-load=\"onLoad\"\n                           :data=\"smsList\">\n                  <template slot=\"statusCode\" slot-scope=\"scope\">\n                    <span >{{ scope.label == 0?\"成功\":\"失败\" }}</span>\n                  </template>\n                </avue-crud>\n              </div>\n            </el-card>\n          </div>\n        </div>\n      </div>\n    </el-form>\n    <el-dialog :title=\"orderBillRecordPain.title\"\n               :visible.sync=\"orderBillRecordPain.visible\"\n               width=\"80%\"\n               append-to-body=\"true\"\n               :before-close=\"beforeCloseDialog\">\n      <order-bill-record :billId=\"bill.id\"></order-bill-record>\n    </el-dialog>\n    <el-dialog :title=\"clientRiskPain.title\"\n               :visible.sync=\"clientRiskPain.visible\"\n               width=\"80%\"\n               append-to-body=\"true\"\n               :before-close=\"beforeCloseDialog\">\n      <client-risk :clientId=\"client.id\"></client-risk>\n    </el-dialog>\n    <el-dialog :title=\"clientCreditPain.title\"\n               :visible.sync=\"clientCreditPain.visible\"\n               width=\"80%\"\n               append-to-body=\"true\"\n               :before-close=\"beforeCloseDialog\">\n      <client-credit :clientId=\"client.id\"></client-credit>\n    </el-dialog>\n    <el-image-viewer\n      class=\"imageview\"\n      v-if=\"showViewer2\"\n      style=\"z-index:9999 !important;\"\n      :on-close=\"() => {showViewer2 = false;}\"\n      :url-list=\"imageslist\">\n    </el-image-viewer>\n  </div>\n</template>\n\n\n\n<script>\n  import {getDetail} from \"@/api/order/order\";\n  import {getList} from \"@/api/order/operatingrecord\";\n  import {getList as getRecordList} from \"@/api/finance/smsrecord\";\n  import {getList as getNoteList} from \"@/api/order/ordernote\";\n  import {\n    combinationTitle,\n    packageName,\n    indexNumber,\n    buyoutPrice,\n    leaseTypeTitle,\n    calcBuyoutMoney\n  } from \"../../util/order\";\n  import Clipboard from 'clipboard';\n\n  import {deduction,order_express,} from \"../../components/order/order_dialog\";\n  import html2canvas from \"html2canvas\";\n  import JsPDF from 'jspdf'\n  import {getAge, getGenderByIdNumber} from \"../../util/util\";\n  import order_button from \"../../components/order/order_button\";\n  import OrderBillRecord from \"./orderbillrecord\";\n\n  import ClientRisk from \"../order/clientrisk\";\n  import ClientCredit from \"../order/clientcredit\";\n  import {audit, download} from \"../../api/order/order\";\n  import {checkBuyoutStatus, checkReturnStatus} from \"../../util/order\";\n  import ElImageViewer from \"element-ui/packages/image/src/image-viewer\";\n  import vue from \"../../main\";\n  import {toFixed} from \"../../constant/goods/constant\";\n  export default {\n    name: \"\",\n    components: {\n      order_button,\n      OrderBillRecord,\n      ClientRisk,\n      ClientCredit,\n      ElImageViewer\n    },\n    data() {\n      return {\n        orderBillRecordPain: {title: \"\", visible: false},\n        orderId:null,\n        bill: {},\n        table_key:1111,\n        loading:true,\n        activeName:0,\n        entryForm:[],\n        tabs:[\"基本信息\",\"操作记录\",\"存证记录\",\"备注信息\",\"信息发送记录\"],\n        evidences:[],\n        orderBills:[],\n        orderNotes:[],\n        smsList:[],\n        order:{},\n        imageslist:[],\n        clientAuth:{},\n        showViewer2:false,\n        orderInfo:{},\n        clientLink:{},\n        clientRisk:{},\n        clientCredit:{},\n        contracts:{},\n        client:{},\n        receiveGoods:{},\n        userOperatingRecord:[],\n        serveOperatingRecord:[],\n        clientRiskPain: {title: \"\", visible: false},\n        clientCreditPain: {title: \"\", visible: false},\n        option: {\n          searchShow: false,\n          searchMenuSpan: 6,\n          tip: false,\n          border: true,\n          editBtn:false,\n          addBtn:false,\n          delBtn:false,\n          index: false,\n          viewBtn: false,\n          selection: false,\n          searchBtn: false,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          menu: true,\n          menuWidth:240,\n          headerAlign: 'center',\n          align: 'center',\n          column: [\n            {\n              label: \"账单类型\",\n              prop: \"typeName\",\n              search:true,\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入订单编号\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"账单金额\",\n              prop: \"money\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"实付金额\",\n              prop: \"factPayMoney\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"减免金额\",\n              prop: \"reductionMoney\",\n              slot: true,\n\n            },\n            {\n              label: \"优惠金额\",\n              prop: \"couponMoney\",\n              slot: true,\n\n            },\n            {\n              label: \"滞纳金\",\n              slot: true,\n              prop: \"allOverdueMoney\",\n            },\n            {\n              label: \"应付款日期\",\n              width: 110,\n              prop: \"startTime\",\n            },\n            {\n              label: \"付款状态\",\n              prop: \"status\",\n              type: \"select\",\n              dicUrl: \"/api/blade-system/dict/dictionary?code=money_status\",\n              props: {\n                label: \"dictValue\",\n                value: \"dictKey\"\n              },\n            },\n            {\n              label: \"付款笔数\",\n              prop: \"payCount\",\n              rules: [{\n                required: true,\n                message: \"请输入每一期租金\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"创建时间\",\n              width: 140,\n              prop: \"createTime\",\n              rules: [{\n                required: true,\n                message: \"请输入免押方式\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        },\n        option2: {\n          searchShow: false,\n          searchMenuSpan: 6,\n          tip: false,\n          border: true,\n          editBtn:false,\n          addBtn:false,\n          delBtn:false,\n          index: true,\n          viewBtn: false,\n          selection: false,\n          searchBtn: false,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          menu: false,\n          headerAlign: 'center',\n          align: 'center',\n          column: [\n            {\n              label: \"操作说明\",\n              prop: \"title\",\n              slot: true\n            },\n            {\n              label: \"操作时间\",\n              prop: \"createTime\",\n              slot: true\n            }\n          ]\n        },\n        option3: {\n          searchShow: false,\n          searchMenuSpan: 6,\n          tip: false,\n          border: true,\n          editBtn:false,\n          addBtn:false,\n          delBtn:false,\n          index: true,\n          viewBtn: false,\n          selection: false,\n          searchBtn: false,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          menu: false,\n          headerAlign: 'center',\n          align: 'center',\n          column: [\n            {\n              label: \"操作说明\",\n              prop: \"title\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"操作人\",\n              prop: \"title\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"操作时间\",\n              prop: \"createTime\",\n              rules: [{\n                required: true,\n                message: \"请输入租期结束日\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        },option4: {\n          searchShow: false,\n          searchMenuSpan: 6,\n          tip: false,\n          border: true,\n          editBtn:false,\n          addBtn:false,\n          delBtn:false,\n          index: false,\n          viewBtn: false,\n          selection: false,\n          searchBtn: false,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          menu: false,\n          headerAlign: 'center',\n          align: 'center',\n          column: [\n            {\n              label: \"存证类型\",\n              prop: \"typeName\",\n              search:true,\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入订单编号\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"附件\",\n              prop: \"money\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"创建时间\",\n              prop: \"factPayMoney\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        },\n        option5: {\n          searchShow: false,\n          searchMenuSpan: 6,\n          tip: false,\n          border: true,\n          editBtn:false,\n          addBtn:false,\n          delBtn:false,\n          index: false,\n          viewBtn: false,\n          selection: false,\n          searchBtn: false,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          menu: false,\n          headerAlign: 'center',\n          align: 'center',\n          column: [\n            {\n              label: \"阶段\",\n              width:100,\n              prop: \"orderStatus\",\n              type: \"select\",\n              search: true,\n              dicUrl: \"/api/blade-system/dict/dictionary?code=order_status\",\n              props: {\n                label: \"dictValue\",\n                value: \"dictKey\"\n              },\n              rules: [{\n                required: true,\n                message: \"请输入订单编号\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"备注信息\",\n              prop: \"note\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"备注人\",\n              prop: \"userName\",\n              width:100,\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"备注时间\",\n              prop: \"createTime\",\n              width:150,\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入租期起始日\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        },\n        page: {\n          sms:{pageSize: 10,\n            currentPage: 1,\n            total: 0},\n          note:{pageSize: 10,\n            currentPage: 1,\n            total: 0},\n        },\n        option6: {\n          searchShow: false,\n          searchMenuSpan: 6,\n          tip: false,\n          border: true,\n          editBtn:false,\n          addBtn:false,\n          delBtn:false,\n          index: false,\n          viewBtn: false,\n          selection: false,\n          searchBtn: false,\n          filterBtn: false,\n          refreshBtn: false,\n          columnBtn: false,\n          menu: false,\n          headerAlign: 'center',\n          align: 'center',\n          column: [\n            {\n              label: \"阶段\",\n              prop: \"orderStatus\",\n              type: \"select\",\n              width:100,\n              search: true,\n              dicUrl: \"/api/blade-system/dict/dictionary?code=order_status\",\n              props: {\n                label: \"dictValue\",\n                value: \"dictKey\"\n              },\n            },\n            {\n              label: \"发送内容\",\n              prop: \"params\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"发送人\",\n              prop: \"userName\",\n              width:\"100\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入商品ID\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"发送结果\",\n              prop: \"statusCode\",\n              width:\"100\",\n              slot: true,\n              rules: [{\n                required: true,\n                message: \"请输入租期起始日\",\n                trigger: \"blur\"\n              }]\n            },\n            {\n              label: \"发送时间\",\n              prop: \"createTime\",\n              width:\"160\",\n              rules: [{\n                required: true,\n                message: \"请输入租期结束日\",\n                trigger: \"blur\"\n              }]\n            }\n          ]\n        }\n      };\n    },\n    beforeDestroyed() {\n    },\n    mounted() {\n\n    },\n    created() {\n      // this.loading = true;\n      this.orderId=this.$route.query.orderId;\n      this.getDetail()\n      this.getRecord();\n    },\n    watch: {\n      activeName: function (){\n        console.log(\"option变化了\")\n        this.table_key = new Date().getTime();\n      },\n    },\n    methods: {\n      viewImage(){\n        this.imageslist = [];\n        if (this.clientAuth.idCardFrontUrl){\n          this.imageslist.push(this.clientAuth.idCardFrontUrl)\n          this.imageslist.push(this.clientAuth.idCardBackUrl)\n        }\n        if (this.clientAuth.faceUrl){\n          this.imageslist.push(this.$store.state.common.cloudDomain+this.clientAuth.faceUrl)\n        }\n        console.log(this.imageslist)\n      },\n      buyoutStatus(){\n        return \"买断\"+checkBuyoutStatus(this.order)\n      },\n      returnStatus(){\n        return \"归还\"+checkReturnStatus(this.order)\n      },\n      getSex(cardNo){\n        return getGenderByIdNumber(cardNo)\n      },\n      getAge(cardNo){\n        return getAge(cardNo);\n      },\n      getRecord(){\n        var param = {orderId:this.orderId};\n        getList(1,1000,param).then(res => {\n          this.userOperatingRecord = []\n          this.serveOperatingRecord = []\n          console.log(res.data.data.records)\n          for (const item of res.data.data.records) {\n            if (item.clientId&&item.clientId != -1){\n              this.userOperatingRecord.push(item)\n            }else{\n              this.serveOperatingRecord.push(item)\n            }\n          }\n          // this.loading = false;\n          this.$nextTick(() => {\n            this.loading = false;\n          })\n        }).catch(res => {\n          this.$nextTick(() => {\n            this.loading = false;\n          })\n        })\n      },\n      getDetail(){\n        // var loadinstance = Loading.service({fullscreen:true})\n        this.loading = true;\n        getDetail(this.orderId).then(res => {\n          this.order = res.data.data.order;\n          this.orderInfo = res.data.data.orderInfo;\n          this.clientAuth = res.data.data.clientAuth;\n          this.orderBills = res.data.data.bills;\n          this.clientLink = res.data.data.detail;\n          this.client = res.data.data.client;\n          this.receiveGoods = res.data.data.receiveGoods;\n          this.clientRisk = res.data.data.clientRisk;\n          this.clientCredit = res.data.data.clientCredit;\n          this.contracts = res.data.data.contracts;\n\n          this.orderBills.sort(function(a, b){\n            var orderNumber1 = a.orderNumber?a.orderNumber:0;\n            var orderNumber2 = b.orderNumber?b.orderNumber:0;\n            if (orderNumber1>orderNumber2){\n              return 1;\n            }else if (orderNumber1<orderNumber2){\n              return -1;\n            }else {\n              return 0;\n            }\n            return 0;\n          });\n\n          this.order.payRentMoney = 0;\n          this.order.noPayRentMoney = 0;\n          this.order.hasPayMoney = 0;\n          this.order.noPayMoney = 0;\n          for (var  bill of this.orderBills) {\n            if (bill.type == \"2\"){\n              continue;\n            }\n            if (bill.type == '10'){\n              continue;\n            }\n            var pay = Number.parseFloat(bill.factPayMoney)+Number.parseFloat(bill.reductionMoney)\n              +Number.parseFloat(bill.couponMoney)+Number.parseFloat(bill.depositMoney);\n            if (bill.type ==5){\n              this.order.payRentMoney = this.order.payRentMoney + pay;\n              this.order.noPayRentMoney = this.order.noPayRentMoney + Number.parseFloat(bill.money) -pay;\n            }\n            this.order.hasPayMoney = this.order.hasPayMoney + pay;\n            var start = new Date(bill.paymentTime);\n            var now = new Date().getTime();\n            if (start.getTime()<=now){\n              this.order.noPayMoney = this.order.noPayMoney + Number.parseFloat(bill.money) - pay;\n            }\n          }\n          this.order.payRentMoney = toFixed(this.order.payRentMoney,2)\n          this.order.noPayRentMoney = toFixed(this.order.noPayRentMoney,2)\n          this.order.hasPayMoney = toFixed(this.order.hasPayMoney,2)\n          this.order.noPayMoney = toFixed(this.order.noPayMoney,2)\n\n          this.order.hasFreeze = 1;\n\n          if (this.receiveGoods){\n            this.order.sendVoucher = this.receiveGoods.sendVoucher\n            this.order.sendNote = this.receiveGoods.sendNote\n            this.order.depositType = this.receiveGoods.depositType\n            this.order.destroyJson = this.receiveGoods.destroyJson\n          }\n          this.order.bills = this.orderBills;\n          if (this.order.entryForm)\n            this.entryForm = JSON.parse(this.order.entryForm)\n          this.$nextTick(() => {\n            this.loading = false;\n          })\n          this.viewImage()\n        }).catch(res => {\n          this.$nextTick(() => {\n            this.loading = false;\n          })\n        })\n      },\n      copy(bt){\n        let clipboard = new Clipboard(bt);\n        clipboard.on('success', e => {\n          this.$message({\n            type: \"success\",\n            message: \"复制成功!\"\n          });\n          clipboard.destroy()\n        })\n        clipboard.on('error', e => {\n          // 不支持复制\n          this.$message({\n            type: \"success\",\n            message: \"该浏览器不支持自动复制!\"\n          });\n          clipboard.destroy()\n        })\n      },\n      onLoad(page, params = {}) {\n        var param = {orderId:this.orderId};\n        getRecordList(page.currentPage, page.pageSize,param).then(res => {\n          const data = res.data.data;\n          this.page.total = data.total;\n          this.smsList = data.records;\n        }).catch(res => {\n\n        })\n      },\n      onNotesLoad(page, params = {}) {\n        var param = {orderId:this.orderId};\n        getNoteList(1, 1000,param).then(res => {\n          const data = res.data.data;\n          this.page.total = data.total;\n          this.orderNotes = data.records;\n        }).catch(res => {\n\n        })\n      },\n      start() {\n\n      },\n      end(key){\n        console.log(\"--2---\",key)\n        this.table_key = new Date().getTime();\n        if (key == \"entryForm\" || key == \"changeBt\" || key == \"deductMoney\" || key ==  \"buyout_check\" || key == 'return_check' || key == \"order_buyout\"){\n          this.getDetail()\n          this.getRecord();\n        }\n        if (key == \"edit\"){\n          this.getDetail()\n          this.getRecord();\n        }\n        if (key == \"cancle\"){\n          this.getDetail()\n          this.getRecord();\n        }\n        if (key == \"pass\"){\n          this.getDetail()\n          this.getRecord();\n        }\n      },\n      goback(){\n        this.$EventBus.$emit('tag', {\n          action:\"remove\",\n          value:\"/order/view/index\",\n          isOpenTag:true,\n          isMatchAll:false\n        })\n      },\n      goodsInfo(){\n        this.$router.push({\n          path: \"/goods/view/index\",\n          query: {\n            goodsId : this.order.goodsId,\n          },\n        });\n      },\n      refer(){\n        this.getDetail();\n        this.getRecord();\n      },\n      express(orderId){\n        order_express({data:this.order.id,key:\"orderExpress\",fn:null})\n      },\n      currentChange(currentPage){\n        this.page.currentPage = currentPage;\n      },\n      sizeChange(pageSize){\n        this.page.pageSize = pageSize;\n      },\n      getLeaseTypeTitle(val){\n        var ss = leaseTypeTitle(val)\n        return ss;\n      },\n      getCombinationTitle(val){\n        return combinationTitle(val);\n      },\n      getPackageName(val){\n        return packageName(val);\n      },\n      getNperNumber(){\n        return indexNumber(this.order,this.orderBills);\n      },\n      getBuyoutPrice(val){\n        return buyoutPrice(val,this.order.totalPricesRate)\n      },\n      getPremiumMoney(val){\n        if (!val)\n          return\n        return JSON.parse(val).premiumMoney\n      },\n      getNowBuyoutMoney(){\n        return toFixed(calcBuyoutMoney(this.order,this.orderBills),2)\n      },\n      getOrderNperNumber(val){\n        console.log()\n        if (val.row.type == 5){\n          return \"第\"+val.row.orderNumber+\"期租金\"\n        }else{\n          return val.label;\n        }\n      },\n      contractDownload(key){\n        var name = this.contracts[key].contractName;\n        download(this.contracts[key].contractNo).then(res => {\n          var pdf = res.data.data.data;\n          const linkSource = `data:application/pdf;base64,${pdf}`;\n          const downloadLink = document.createElement(\"a\");\n          downloadLink.href = linkSource;\n          downloadLink.download = name+\".pdf\";\n          downloadLink.click();\n        }).catch(res => {\n        });\n      },\n      pdfDownload() {\n        console.log(\"----------\")\n        let images = [];\n        let _this = this\n        let enterForm = this.$refs.enterForm; //获取ref里面的内容\n        let basicInfo = this.$refs.basicInfo;\n        let height = 0;\n        let PDF = new JsPDF('', 'pt', 'a4')\n        html2canvas(basicInfo, {\n          useCORS: true, //是否尝试使用CORS从服务器加载图像\n          allowTaint: true,\n          dpi: 300, //解决生产图片模糊\n          scale: 3, //清晰度--放大倍数\n        }).then(function (canvas) {\n          let contentWidth = canvas.width\n          let contentHeight = canvas.height\n          let pageHeight = contentWidth / 592.28 * 841.89 // 一页pdf显示html页面生成的canvas高度;\n          let leftHeight = contentHeight //未生成pdf的html页面高度\n          let position = 0 //pdf页面偏移\n          //a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高\n          // let imgWidth = 595.28\n          let imgWidth = 560.28  //宽度\n          let imgHeight = 592.28 / contentWidth * contentHeight\n          let pageData = canvas.toDataURL('image/jpeg', 1.0)\n          // 有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)\n          //当内容未超过pdf一页显示的范围，无需分页\n          PDF.addImage(pageData, 'JPEG', 20, 20, imgWidth, imgHeight)\n          height = height+imgHeight\n          console.log(\"----------\",enterForm)\n          html2canvas(enterForm, {\n            useCORS: true, //是否尝试使用CORS从服务器加载图像\n            allowTaint: true,\n            dpi: 300, //解决生产图片模糊\n            scale: 3, //清晰度--放大倍数\n          }).then(function (canvas) {\n            let contentWidth = canvas.width\n            let contentHeight = canvas.height\n            let pageHeight = contentWidth / 592.28 * 841.89 // 一页pdf显示html页面生成的canvas高度;\n            let leftHeight = contentHeight //未生成pdf的html页面高度\n            let position = 0 //pdf页面偏移\n            //a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高\n            // let imgWidth = 595.28\n            let imgWidth = 560.28  //宽度\n            let imgHeight = 592.28 / contentWidth * contentHeight\n            let pageData = canvas.toDataURL('image/jpeg', 1.0)\n            // 有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)\n            //当内容未超过pdf一页显示的范围，无需分页\n            let start = height;\n            height = height+imgHeight;\n            if (leftHeight < pageHeight) {\n              PDF.addImage(pageData, 'JPEG', 20, start+50, imgWidth, imgHeight)\n            } else {\n                // while (leftHeight > 0) {\n                //   PDF.addImage(pageData, 'JPEG', 20, height, imgWidth, imgHeight)\n                //   leftHeight -= pageHeight\n                //   position -= 841.89\n                //   if (leftHeight > 0) {\n                //     PDF.addPage()\n                //   }\n                // }\n            }\n            let title = _this.order.clientName+\" \"+_this.order.no+\"进件单\"\n            PDF.save(_this.$t(title) + '.pdf')//下载标题\n          })\n        });\n      },\n      beforeCloseDialog(done) {\n        done();\n      },\n      showDialogPage(row, type) {\n        if (type == 'orderBillRecord') {\n          this.bill = row;\n          this.orderBillRecordPain.visible = true;\n          this.orderBillRecordPain.title = row.typeName + \" - 支付记录\";\n        }\n        if (type == 'clientRisk') {\n          this.clientRiskPain.visible = true;\n          this.clientRiskPain.title = this.clientAuth.name + \" - 风控报告\";\n        }\n        if (type == 'clientCredit') {\n          this.clientCreditPain.visible = true;\n          this.clientCreditPain.title = this.clientAuth.name + \" - 征信报告\";\n        }\n      },\n      deductMoney(row,type) {\n        var fn = {start:this.start,end:this.end}\n        var order = {...row}\n        order.openType = type\n        order.hasBill = true\n        deduction({data:order,key:\"deductMoney\",fn:fn});\n      },\n    }\n  }\n</script>\n\n<style scoped>\n  .top-bar-title {\n    height: auto;\n    background-color: white;\n    padding: 0px 10px 10px 20px;\n    padding-bottom: 0px !important;\n    margin-left: 6px;\n    margin-right: 6px;\n    display: block;\n    justify-content: space-between;\n    border-bottom: 2px solid #F0F2F5;\n  }\n  .top_item{\n    margin-right: 20px;\n  }\n  :deep .el-tabs__header {\n    margin: 0 0 0px !important;\n  }\n  .top_contain {\n    font-size: 14px;\n    display: flex;\n    justify-content: flex-start;\n    flex-direction: row;\n    flex-wrap: wrap;\n    align-items: flex-end;\n    margin-top: 10px;\n    margin-bottom: 10px;\n  }\n\n  :deep .head-class {\n    background-color: white !important;\n  }\n  .info {\n    margin-top: 5px;\n    margin-left: 6px;\n    margin-right: 6px;\n  }\n\n  .info  :deep .clearfix:before {\n    content: unset !important;\n  }\n  .info  :deep .clearfix:after{\n    content: unset !important;\n  }\n\n\n  .info .text {\n    font-size: 14px;\n  }\n\n  .info .item {\n    margin-bottom: 18px;\n  }\n\n  :deep .el-card__header {\n    padding: 18px 20px !important;\n  }\n\n  .info .clearfix:before,\n  .info .clearfix:after {\n    display: table;\n    content: \"\";\n  }\n\n  .top :deep .el-form-item {\n    margin-bottom: 0px;\n  }\n\n  .top :deep .el-col {\n    margin-bottom: 0px;\n  }\n\n  .user_info :deep .el-form-item {\n    margin-bottom: 0px;\n  }\n\n  .user_info .logistics {\n    padding: 5px 10px;\n    font-size: 14px;\n  }\n\n  .user_info :deep .el-col {\n    margin-bottom: 0px;\n  }\n\n  .info .clearfix:after {\n    clear: both\n  }\n  :deep .el-tabs__nav-wrap::after{\n    background-color: #F0F2F5;\n  }\n  .user_info table{\n    font-size: 14px;\n    width: 100%;\n    border-top: 1px solid #00000015;\n    border-left: 1px solid #00000015;\n    border-collapse: collapse; /*设置单元格的边框合并为1*/\n  }\n  .user_info td{\n    width: 33%;\n    border-bottom: 1px solid #00000015;\n    border-right: 1px solid #00000015;\n    padding: 10px 20px;\n  }\n\n  :deep .avue-crud__menu {\n    display: none;\n  }\n\n  :deep .head-class {\n    background-color: white !important;\n  }\n  .div_table {\n    width: 100%;\n  }\n\n  .table_border{\n    border-right: 1px solid #E9E9E9;\n    border-bottom: 1px solid #E9E9E9;\n  }\n\n  .div_header {\n    background-color: #FAFAFA;\n    color: #108EE9;\n    padding: 10px 20px;\n    font-size: 14px;\n    font-weight: bold;\n    border-top: 1px solid #E9E9E9;\n    border-left: 1px solid #E9E9E9;\n  }\n  .div_top {\n    width: 100%;\n    background-color: #169BD533;\n  }\n  .div_top .div_item {\n    flex: 1;\n    padding-top: 8px;\n    padding-bottom: 8px;\n    text-align: center;\n    font-size: 14px;\n  }\n\n  .div_content {\n    width: 100%;\n    display: flex;\n    flex-direction: row;\n    border-left: 1px solid #E9E9E9;\n  }\n\n  .div_content .div_item {\n    text-align: center;\n    font-size: 14px;\n  }\n  :deep .el-empty {\n    padding: 0px 0px !important;\n  }\n  :deep .avue-crud__empty {\n    padding: 0px 0px !important;\n  }\n</style>\n<style>\n  .avue-dialog .el-dialog {\n    display: flex;\n    display: -ms-flex; /* 兼容IE */\n    flex-direction: column;\n    -ms-flex-direction: column; /* 兼容IE */\n    margin:0 !important;\n    position:absolute;\n    top:50%;\n    left:50%;\n    transform:translate(-50%,-50%);\n    max-height:calc(100% - 30px);\n    max-width:calc(100% - 30px);\n  }\n  .el-dialog .el-dialog__body{\n    max-height: 100%;\n    flex: 1;\n    -ms-flex: 1 1 auto; /* 兼容IE */\n    overflow-y: auto;\n    overflow-x: hidden;\n  }\n\n  .el-dialog__wrapper {\n    /*隐藏ie和edge中遮罩的滚动条*/\n    overflow: hidden;\n  }\n\n  :deep .el-card__body {\n    padding-top: 10px !important;\n  }\n\n  .item_w {\n   width: 200px;\n  }\n\n  .my-label {\n    background: #169BD533 !important;\n    text-align: center !important;\n    color: #666 !important;\n  }\n\n  .my-content {\n    text-align: center !important;\n  }\n</style>\n"]}]}